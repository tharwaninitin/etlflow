(this["webpackJsonpetlflow-updated"]=this["webpackJsonpetlflow-updated"]||[]).push([[0],{20:function(t,e,s){},50:function(t,e,s){"use strict";s.r(e);var a=s(1),n=s.n(a),r=s(30),i=s.n(r),c=s(3),o=s(4),l=s(12),d=s(6),u=s(5),b=s(2),j=s.n(b),h=s(8),p=s(31),m="/api/etlflow",f=function(t,e){var s=localStorage.getItem("Authorization");return fetch(t,{method:"POST",headers:{content_type:"applcation/json",Authorization:s},body:JSON.stringify({query:e})})},O=s(0),x=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).state={currentime:""},a}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return" query {  currentime {  current_time  } } ",t.next=3,f(m," query {  currentime {  current_time  } } ");case 3:return e=t.sent,t.next=6,e.json();case 6:return s=t.sent,a=s.data,t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=this;this.fetchEtlFlowJobs().then((function(e){var s=e.currentime;t.setState((function(t){return{currentime:s.current_time}}))}))}},{key:"render",value:function(){return Object(O.jsx)("li",{className:"nav-item",children:Object(O.jsx)("a",{className:"nav-link disabled",children:this.state.currentime})})}}]),s}(n.a.Component),v=(s(27),s(28),s(17)),y=s.n(v);var _=function(t){var e="";return e=0===t.status_code?"ERR_CONNECTION_REFUSED.Server is down":403===t.status_code?"ERR_ABORTED 403 (Forbidden)":t.status_code,Object(O.jsx)("div",{children:Object(O.jsxs)("table",{className:"table table-striped",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsx)("tr",{children:Object(O.jsx)("th",{children:"Error"})})}),Object(O.jsx)("tbody",{children:Object(O.jsx)("tr",{children:Object(O.jsxs)("td",{class:"text-danger",children:[e," "]})})})]})})},g=new URL("/ws/etlflow",window.location.href);g.protocol=g.protocol.replace("http","ws");var k=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;Object(c.a)(this,s);return(a=e.call(this,t)).state={used:"",total:"",free:"",max:"",error:"",error_code:0},a.ws=new WebSocket(g+"/"+localStorage.getItem("Authorization")),a.options={low:0,showArea:!0,showPoint:!1},a}return Object(o.a)(s,[{key:"call",value:function(t){var e=this;if("true"===t)this.ws.close(1e3,"User closed the connection"),document.getElementById("statslinknotify").innerText="Real-Time Stats (Offline)",console.log("ws closed");else{document.getElementById("statslinknotify").innerText="Real-Time Stats (Online)",this.ws.readyState===WebSocket.CLOSED&&(this.ws=new WebSocket(g+"/"+localStorage.getItem("Authorization"))),this.ws.onopen=function(){console.log("ws connected")},this.ws.onmessage=function(t){var s=t.data,a=JSON.parse(s).memory;e.setState((function(t){return{used:a.used,total:a.total,free:a.free,max:a.max}}))},this.ws.onclose=function(){console.log("disconnected")};var s={series:[[]]},a={series:[[]]},n={series:[[]]},r=new y.a.Line(".ct-chart",s,this.options),i=new y.a.Line(".cpu-chart",a,this.options),c=new y.a.Line(".cpu-chart-1",n,this.options);this.updateMemoryChart(r,s,this.getMemoryData("usedMemory"),"usedMemory",30),this.updateMemoryChart(i,a,this.getMemoryData("freeMemory"),"freeMemory",30),this.updateMemoryChart(c,n,this.getMemoryData("totalMemory"),"totalMemory",30)}}},{key:"componentDidMount",value:function(){this.call()}},{key:"componentWillUnmount",value:function(){this.ws.close()}},{key:"getMemoryData",value:function(t){var e=[],s=[],a=[];return"usedMemory"===t?(e.push(this.state.used),e[0]):"freeMemory"===t?(s.push(this.state.free),s[0]):(a.push(this.state.total),a[0])}},{key:"updateMemoryChart",value:function(t,e,s,a,n){var r=this;e.series[0].length>=n&&e.series[0].shift(),e.series[0].push(s),t.update(e),setTimeout((function(){r.updateMemoryChart(t,e,r.getMemoryData(a),a,n)}),1e3)}},{key:"render",value:function(){var t=this;return""!==this.state.error?Object(O.jsx)("div",{children:Object(O.jsx)(_,{error:this.state.error})}):Object(O.jsxs)("div",{class:"card",children:[Object(O.jsxs)("div",{class:"card-header",children:[Object(O.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify",role:"button","aria-expanded":"true","aria-controls":"streamnotify",id:"statslinknotify"}),Object(O.jsxs)("ul",{class:"pagination float-right",children:[Object(O.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.call("false")},children:"Connect"}),Object(O.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.call("true")},children:"Close"})]})]}),Object(O.jsx)("div",{className:"collapse",id:"streamnotify",children:Object(O.jsxs)("div",{class:"card-body",children:[Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-sm-3",children:Object(O.jsxs)("div",{class:"card",children:[Object(O.jsx)("div",{class:"card-header",children:"Used Memory"}),Object(O.jsx)("div",{class:"card-body",children:Object(O.jsx)("div",{class:"ct-chart"})})]})}),Object(O.jsx)("div",{class:"col-sm-3",children:Object(O.jsxs)("div",{class:"card",children:[Object(O.jsx)("div",{class:"card-header",children:"Free Memory"}),Object(O.jsx)("div",{class:"card-body",children:Object(O.jsx)("div",{class:"cpu-chart"})})]})}),Object(O.jsx)("div",{class:"col-sm-3",children:Object(O.jsxs)("div",{class:"card",children:[Object(O.jsx)("div",{class:"card-header",children:"Total Memory"}),Object(O.jsx)("div",{class:"card-body",children:Object(O.jsx)("div",{class:"cpu-chart-1 "})})]})}),Object(O.jsx)("div",{class:"col-sm-3",children:Object(O.jsxs)("div",{class:"card",children:[Object(O.jsx)("div",{class:"card-header",children:"Current Usage"}),Object(O.jsx)("div",{class:"card-body",children:Object(O.jsx)("div",{children:Object(O.jsxs)("ul",{class:"list-group ",children:[Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Used Memory"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.used})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Free Memory"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.free})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Total Memory"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.total})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Max Memory"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.max})]})]})})})]})})]}),Object(O.jsx)("br",{})]})})]})}}]),s}(n.a.Component),S=s(10);var w=function(t){return Object(O.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.call()},children:"Refresh"})};var C=function(){return Object(O.jsx)("div",{class:"d-flex justify-content-center",children:Object(O.jsx)("div",{class:"spinner-border m-5",role:"status",children:Object(O.jsx)("span",{class:"sr-only",children:"Loading..."})})})},J=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){return""!==this.props.error?Object(O.jsxs)("div",{class:"container",children:[Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsx)(w,{call:this.props.setMetrics})}),Object(O.jsx)(_,{status_code:this.props.error_code})]}):this.props.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsxs)("div",{class:"card",children:[Object(O.jsxs)("div",{class:"card-header",children:[Object(O.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify2",role:"button","aria-expanded":"true","aria-controls":"streamnotify",id:"statslinknotify",children:"Metrics"}),Object(O.jsx)("ul",{class:"pagination float-right",children:Object(O.jsx)(w,{call:this.props.setMetrics})})]}),Object(O.jsx)("div",{className:"collapse",id:"streamnotify2",children:Object(O.jsx)("div",{class:"card-body",children:Object(O.jsxs)("ul",{class:"list-group",children:[Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Active Jobs"}),Object(O.jsx)("span",(t={class:"items1s"},Object(S.a)(t,"class","badge badge-secondary badge-pill"),Object(S.a)(t,"children",this.props.data.active_jobs),t))]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Active Subscribers"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.props.data.active_subscribers})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Etl Jobs"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.props.data.etl_jobs})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Cron Jobs"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.props.data.cron_jobs})]}),Object(O.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(O.jsx)("b",{children:"Build Time"}),Object(O.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.props.data.build_time})]})]})})})]});var t}}]),s}(n.a.Component),N=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setJobLogs=function(t){a.callApi().then((function(e){var s=e.jobLogs;a.setState((function(e){return{jobLogs:s,load_bar:t}}),(function(){return a.barChart()}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={jobLogs:[],filter:"",limit:"",error:"",error_code:0,load_bar:!1},a.filterOperation=["2","5","10"],a.limitOperation=["2","5","10","30","50"],a.options={low:0,showArea:!0,showPoint:!1},a}return Object(o.a)(s,[{key:"callApi",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=" query { jobLogs { job_name success failed }}",""!==this.state.filter&&""!==this.state.limit?e=" query { jobLogs(limit: ".concat(this.state.limit,", filter: ").concat(this.state.filter,"  ) { job_name success failed }}"):""!==this.state.filter?e=" query { jobLogs(filter: ".concat(this.state.filter,") { job_name success failed }}"):""!==this.state.limit&&(e=" query { jobLogs(limit: ".concat(this.state.limit,") { job_name success failed }}")),this.setState((function(t){return{loader:!0,error:""}})),t.next=5,f(m,e);case 5:if(403===(s=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),s.ok){t.next=13;break}throw a="An error has occured: ".concat(s.statusText),this.setState((function(t){return{error_code:s.status}})),new _(a);case 13:return t.next=15,s.json();case 15:return n=t.sent,r=n.data,t.abrupt("return",r);case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setErrorState",value:function(t,e){this.setState((function(s){return{error:t,error_code:e}}))}},{key:"barChart",value:function(){var t={seriesBarDistance:10,axisX:{offset:60},axisY:{offset:80,labelInterpolationFnc:function(t){return t},scaleMinSpace:15}};if(this.state.load_bar){var e=[],s=[],a=[];this.state.jobLogs.map((function(t){e.push(t.job_name),s.push(t.success),a.push(t.failed)})),new y.a.Bar(".ct-chart-2",{labels:e,series:[s,a]},t)}else new y.a.Bar(".ct-chart-2",{labels:[0],series:[[0],[0]]},t)}},{key:"componentDidMount",value:function(){this.setJobLogs(!1),this.barChart()}},{key:"setInitialState",value:function(){var t=this;this.setState((function(t){return{filter:"",limit:""}}),(function(){return t.setJobLogs(!0)}))}},{key:"render",value:function(){var t=this,e="",s="";return e=""!==this.state.filter?this.state.filter:"Add Filter (In Days)",s=""!==this.state.limit?this.state.limit:"Add limit",""!==this.state.error?Object(O.jsxs)("div",{class:"container",children:[Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setJobLogs(!0)},children:"Refresh"})}),Object(O.jsx)(_,{status_code:this.state.error_code})]}):Object(O.jsxs)("div",{class:"card",children:[Object(O.jsxs)("div",{class:"card-header",children:[Object(O.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify1",role:"button","aria-expanded":"true","aria-controls":"streamnotify1",children:"Etl Jobs Vs Count (Success/Failed)"}),Object(O.jsxs)("ul",{class:"pagination float-right",children:[Object(O.jsxs)("div",{class:"dropdown",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:e}),Object(O.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(O.jsx)("a",{class:"dropdown-item",children:Object(O.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{filter:e}}))},children:[" ",e," "]})})}))})]}),Object(O.jsxs)("div",{class:"dropdown",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:s}),Object(O.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.limitOperation.map((function(e){return Object(O.jsx)("a",{class:"dropdown-item",children:Object(O.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{limit:e}}))},children:[" ",e," "]})})}))})]}),Object(O.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.setInitialState()},children:"Clear"}),Object(O.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.setJobLogs(!0)},children:"Refresh"})]})]}),Object(O.jsx)("div",{className:"collapse",id:"streamnotify1",children:Object(O.jsx)("div",{class:"card-body",children:Object(O.jsx)("div",{class:"ct-chart-2"})})})]})}}]),s}(n.a.Component),M=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setMetrics=function(){a.fetchEtlFlowMetrics().then((function(t){var e=t.metrics;a.setState((function(t){return{metrics:e,loader:!1}}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={metrics:[],error:"",loader:!1,error_code:0},a}return Object(o.a)(s,[{key:"fetchEtlFlowMetrics",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState((function(t){return{loader:!0,error:""}}))," query { metrics { active_jobs  active_subscribers etl_jobs cron_jobs  build_time } }",t.next=4,f(m," query { metrics { active_jobs  active_subscribers etl_jobs cron_jobs  build_time } }");case 4:if(403===(e=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),e.ok){t.next=12;break}throw s="An error has occured: ".concat(e.statusText),this.setState((function(t){return{error_code:e.status}})),new Error(s);case 12:return t.next=14,e.json();case 14:return a=t.sent,n=a.data,t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.setMetrics()}},{key:"render",value:function(){return Object(O.jsxs)("div",{class:"container-fluid",children:[Object(O.jsx)(k,{logout:this.props.logout}),Object(O.jsx)("br",{}),Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-sm-9",children:Object(O.jsx)(N,{logout:this.props.logout})}),Object(O.jsx)("div",{class:"col-sm-3",children:Object(O.jsx)(J,{data:this.state.metrics,setMetrics:this.setMetrics,error:this.state.error,error_code:this.state.error_code,loader:this.state.loader})})]})]})}}]),s}(n.a.Component),E=s(16);var I=function(t){var e="";return t.notification&&(e=t.is_error?Object(O.jsxs)("div",{class:"alert alert-danger alert-dismissible fade show",role:"alert",children:[Object(O.jsx)("h4",{class:"alert-heading",children:t.message}),Object(O.jsx)("p",{children:t.errors}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.setNotification(!1)},children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}):Object(O.jsxs)("div",{class:"alert alert-success alert-dismissible fade show",role:"alert",children:[Object(O.jsx)("h4",{class:"alert-heading",children:t.message}),Object(O.jsx)("p",{children:t.job_props}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.setNotification(!1)},children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})),Object(O.jsx)("div",{children:e})},L=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setNotification=function(t){a.setState((function(e){return{notification:t}}))},a.state={credential:[],loader:!1,jdbc_values:[],aws_values:[],jdbc_keys:["url","user","password","driver"],aws_keys:["access_key","secret_key"],errors:"",is_error:!1,credential_name:"",credential_type:"",insert_credential_type:"",error:"",error_code:0},a.filterOperation=["JDBC","AWS"],a}return Object(o.a)(s,[{key:"updateCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s,a){var n,r,i,c,o,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.stringify(a).replaceAll('"?',"").replaceAll('?"',""),r=' mutation { update_credentials (name:"'.concat(e,'", type:JDBC, value: ').concat(n,") { name } }"),"aws"===s&&(r=' mutation { update_credentials (name:"'.concat(e,'", type:AWS, value: ').concat(n,") { name } }")),t.next=5,f(m,r);case 5:if(403===(i=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),i.ok){t.next=13;break}throw c="An error has occured: ".concat(i.statusText),this.setState((function(t){return{error_code:i.status}})),new Error(c);case 13:return t.next=15,i.json();case 15:return o=t.sent,l=o.data,d=o.errors,null!==JSON.parse(JSON.stringify(l.update_credentials))?this.setJobErrorDeails(!1):this.setJobErrorDeails(!0,JSON.parse(JSON.stringify(d))),t.abrupt("return",l);case 20:case"end":return t.stop()}}),t,this)})));return function(e,s,a){return t.apply(this,arguments)}}()},{key:"insertCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s,a){var n,r,i,c,o,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=JSON.stringify(a).replaceAll('"?',"").replaceAll('?"',""),r=' mutation { add_credentials (name:"'.concat(e,'", type:JDBC, value: ').concat(n,") { name } }"),"AWS"===s&&(r=' mutation { add_credentials (name:"'.concat(e,'", type:AWS, value: ').concat(n,") { name } }")),t.next=5,f(m,r);case 5:if((i=t.sent).ok){t.next=12;break}throw c="An error has occured: ".concat(i.statusText),this.setState((function(t){return{error_code:i.status}})),new Error(c);case 12:return t.next=14,i.json();case 14:return o=t.sent,l=o.data,d=o.errors,null!==JSON.parse(JSON.stringify(l.add_credentials))?this.setJobErrorDeails(!1):this.setJobErrorDeails(!0,d[0].message),t.abrupt("return",l);case 19:case"end":return t.stop()}}),t,this)})));return function(e,s,a){return t.apply(this,arguments)}}()},{key:"setUpdateCredInitialState",value:function(){this.setState((function(t){return{aws_values:[],jdbc_values:[]}}))}},{key:"createUpdateCredUI",value:function(){var t=this;return"jdbc"===this.state.credential_type?this.state.jdbc_keys.map((function(e,s){return Object(O.jsx)("div",{children:Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.jdbc_keys[s],disabled:!0})})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:"***********",onChange:t.setInsertValues.bind(t,s)})})})]})},s)})):"aws"===this.state.credential_type?this.state.aws_keys.map((function(e,s){return Object(O.jsx)("div",{children:Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.aws_keys[s],disabled:!0})})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:"***********",onChange:t.setInsertValues.bind(t,s)})})})]})},s)})):void 0}},{key:"createAddCredUI",value:function(){var t=this;return"JDBC"===this.state.insert_credential_type?this.state.jdbc_keys.map((function(e,s){return Object(O.jsx)("div",{children:Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.jdbc_keys[s],disabled:!0})})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:"Type Value",onChange:t.setValues.bind(t,s)})})})]})},s)})):"AWS"===this.state.insert_credential_type?this.state.aws_keys.map((function(e,s){return Object(O.jsx)("div",{children:Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.aws_keys[s],disabled:!0})})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",type:"text",placeholder:"Type Value",onChange:t.setValues.bind(t,s)})})})]})},s)})):void 0}},{key:"setAddCredInitialState",value:function(){this.setState((function(t){return{insert_credential_type:"",aws_values:[],jdbc_values:[]}})),document.getElementById("cred_name").value=""}},{key:"setValues",value:function(t,e){if("JDBC"===this.state.insert_credential_type){var s=Object(E.a)(this.state.jdbc_values);s[t]=e.target.value,this.setState({jdbc_values:s})}else{var a=Object(E.a)(this.state.aws_values);a[t]=e.target.value,this.setState({aws_values:a})}}},{key:"setInsertValues",value:function(t,e){if("jdbc"===this.state.credential_type){var s=Object(E.a)(this.state.jdbc_values);s[t]=e.target.value,this.setState({jdbc_values:s})}else{var a=Object(E.a)(this.state.aws_values);a[t]=e.target.value,this.setState({aws_values:a})}}},{key:"setCredUpdateDeails",value:function(t){this.setState((function(e){return{credential_name:t}}))}},{key:"updateCredentials",value:function(){var t,e=this,s=[];if("jdbc"===this.state.credential_type)for(t=0;t<this.state.jdbc_keys.length;t++){var a,n=(a={},Object(S.a)(a,"?key?",this.state.jdbc_keys[t]),Object(S.a)(a,"?value?",this.state.jdbc_values[t]),a);s[t]=n}else for(t=0;t<this.state.aws_keys.length;t++){var r;n=(r={},Object(S.a)(r,"?key?",this.state.aws_keys[t]),Object(S.a)(r,"?value?",this.state.aws_values[t]),r);s[t]=n}n="";this.updateCreds(this.state.credential_name,this.state.credential_type,s).then((function(t){var s=t.update_credentials;e.setNotification(!0);JSON.parse(JSON.stringify(s))})).catch((function(t){e.setState((function(e){return{error:t,loader:!1}}))})),this.setState((function(t){return{credential_type:"",aws_values:[],jdbc_values:[]}}))}},{key:"addCredentials",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n,r,i,c=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=[],"JDBC"===this.state.insert_credential_type)for(s=0;s<this.state.jdbc_keys.length;s++)a={},Object(S.a)(a,"?key?",this.state.jdbc_keys[s]),Object(S.a)(a,"?value?",this.state.jdbc_values[s]),n=a,e[s]=n;else for(s=0;s<this.state.aws_keys.length;s++)r={},Object(S.a)(r,"?key?",this.state.aws_keys[s]),Object(S.a)(r,"?value?",this.state.aws_values[s]),n=r,e[s]=n;n="",i=document.getElementById("cred_name").value,this.insertCreds(i,this.state.insert_credential_type,e).then((function(t){var e=t.add_credentials;c.setNotification(!0);JSON.parse(JSON.stringify(e))}),(function(){return c.setAddCredInitialState()})),this.setState((function(t){return{insert_credential_type:"",aws_values:[],jdbc_values:[]}})),document.getElementById("cred_name").value="";case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setJobErrorDeails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"render",value:function(){var t=this;""!==this.state.credential_type&&this.state.credential_type;var e="";e=""!==this.state.insert_credential_type?this.state.insert_credential_type:"Add Credential Type";""!==this.state.credential_type&&this.state.credential_type;var s="",a="",n="";return this.state.notification&&(this.state.is_error?(s="Error while Updatating Credential ! ",a="",n=this.state.errors):(s="Credentials  submitted successfully! ",a="",n="")),Object(O.jsxs)("div",{className:"container",children:[Object(O.jsx)("div",{children:Object(O.jsx)(I,{notification:this.state.notification,is_error:this.state.is_error,errors:n,message:s,job_props:a,setNotification:this.setNotification})}),Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsxs)("div",{class:"inner",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal1",children:"Add New Credentials"}),Object(O.jsx)("div",{class:"modal fade",id:"exampleModal1",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel1","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel1",children:"Add Credentials"}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsxs)("div",{class:"modal-body",children:[Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsxs)("div",{class:"form-group",children:["Credential Name",Object(O.jsx)("input",{class:"form-control",placeholder:"Add Name",type:"text",id:"cred_name"})]})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsxs)("div",{class:"dropdown",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:e}),Object(O.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(O.jsx)("a",{class:"dropdown-item",children:Object(O.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{insert_credential_type:e}}))},children:[" ",e," "]})})}))})]})})})]}),this.createAddCredUI(),Object(O.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.addCredentials()}})]}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})}),Object(O.jsxs)("table",{id:"jobruns",class:"table table-sm table-bordered",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Credential Name"}),Object(O.jsx)("th",{children:"Type"}),Object(O.jsx)("th",{children:"Last Updated"}),Object(O.jsx)("th",{children:"Action"})]})}),Object(O.jsx)("tbody",{children:this.props.data.map((function(e){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:e.name}),Object(O.jsx)("td",{children:e.type}),Object(O.jsx)("td",{children:e.valid_from}),Object(O.jsx)("td",{children:Object(O.jsxs)("div",{class:"inner",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return t.setState((function(t){return{credential_name:e.name,credential_type:e.type}}))},children:"Update"}),Object(O.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Update Credentials"}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsxs)("div",{class:"modal-body",children:[Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsxs)("div",{class:"form-group",children:["Credential Name",Object(O.jsx)("input",{class:"form-control",placeholder:t.state.credential_name,type:"text",disabled:!0})]})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsxs)("div",{class:"form-group",children:["Type",Object(O.jsx)("input",{class:"form-control",placeholder:t.state.credential_type,type:"text",disabled:!0})]})})]}),t.createUpdateCredUI(),Object(O.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.updateCredentials()}})]}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})})]})}))})]})]})}}]),s}(n.a.Component),A=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setCredentials=function(){a.fetchEtlFlowCreds().then((function(t){var e=t.credential;a.setState((function(t){return{credential:e,loader:!1}}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={credential:[],loader:!1,error:"",error_code:0},a}return Object(o.a)(s,[{key:"fetchEtlFlowCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState((function(t){return{loader:!0,error:""}}))," query { credential { name  type  valid_from } } ",t.next=4,f(m," query { credential { name  type  valid_from } } ");case 4:if(403===(e=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),e.ok){t.next=12;break}throw s="An error has occured: ".concat(e.statusText),this.setState((function(t){return{error_code:e.status}})),new _(s);case 12:return t.next=14,e.json();case 14:return a=t.sent,n=a.data,t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.setCredentials()}},{key:"render",value:function(){var t=Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsx)(w,{call:this.setCredentials})});return""!==this.state.error?Object(O.jsxs)("div",{class:"container",children:[t,Object(O.jsx)(_,{status_code:this.state.error_code})]}):this.state.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsxs)("div",{className:"container",children:[t,Object(O.jsx)(L,{data:this.state.credential})]})}}]),s}(n.a.Component),D=(s(39),s(41),s(20),s(7)),R=s(9),F=s.n(R),T=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setNotification=function(t){a.setState((function(e){return{notification:t}}))},a.state={jobs:[],notification:!1,run_job_props:"",job_name:"",errors:[],is_error:!1,is_active:!0,values:[],keys:[],error_code:0},a}return Object(o.a)(s,[{key:"updateJobActiveState",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var a,n,r,i,c;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='mutation {  update_job_state (name:"'.concat(e,'" ,state: ').concat(s,"){ } }"),t.next=3,f(m,a);case 3:if(403===(n=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),n.ok){t.next=11;break}throw r="An error has occured: ".concat(n.statusText),this.setState((function(t){return{error_code:n.status}})),new Error(r);case 11:return t.next=13,n.json();case 13:return i=t.sent,c=i.data,t.abrupt("return",c);case 16:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"runEtlJob",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var a,n,r,i,c,o,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a='\n      mutation {\n        run_job (name:"'.concat(e,'"){\n          name\n          props {key value}\n      }\n      }\n    '),s.length>0&&(n=JSON.stringify(s).replaceAll('"$',"").replaceAll('$"',""),a='\n      mutation {\n        run_job (name:"'.concat(e,'" ,props: ').concat(n,"){\n          name\n          props {key value}\n      }\n      }\n    ")),this.setState((function(t){return{loader:!0}})),t.next=5,f(m,a);case 5:if(403===(r=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),r.ok){t.next=13;break}throw i="An error has occured: ".concat(r.statusText),this.setState((function(t){return{error_code:r.status}})),new Error(i);case 13:return t.next=15,r.json();case 15:return c=t.sent,o=c.data,l=c.errors,null!==JSON.parse(JSON.stringify(o.run_job))?this.setJobErrorDeails(!1):this.setJobErrorDeails(!0,JSON.parse(JSON.stringify(l))),t.abrupt("return",o);case 20:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=F()("#joblist").DataTable({order:[[6,"desc"]]});t.column(6).visible(!1),t.column(3).visible(!1)}},{key:"showModal",value:function(t){var e="";t.map((function(t){return e+="<b>"+t.key+"</b>="+t.value+"<br></br>"})),F()("#jobListeModal .modal-body").html(e),F()("#jobListeModal").modal()}},{key:"setJobDeails",value:function(t,e){this.setState((function(s){return{job_name:t,run_job_props:e}}))}},{key:"setErrorState",value:function(t,e){this.setState((function(s){return{error:t,error_code:e}}))}},{key:"setJobErrorDeails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"handleOnClick",value:function(t){this.props.history.push("/JobRuns/"+t)}},{key:"createUI",value:function(){var t=this;return this.state.values.map((function(e,s){return Object(O.jsx)("div",{children:Object(O.jsxs)("div",{class:"row",children:[Object(O.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",value:t.state.keys[s],type:"text",placeholder:"Type Key",onChange:t.setRunJobKeys.bind(t,s)})})}),Object(O.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(O.jsx)("div",{class:"form-group",children:Object(O.jsx)("input",{class:"form-control",value:e||"",type:"text",placeholder:"Type Value",onChange:t.setRunJobValues.bind(t,s)})})}),Object(O.jsx)("div",{class:"col-xs-3",children:Object(O.jsx)("input",{type:"button",class:"btn btn-danger",value:"-",onClick:t.removeProps.bind(t,s)})})]})},s)}))}},{key:"setRunJobValues",value:function(t,e){var s=Object(E.a)(this.state.values);s[t]=e.target.value,this.setState({values:s})}},{key:"setRunJobKeys",value:function(t,e){var s=Object(E.a)(this.state.keys);s[t]=e.target.value,this.setState({keys:s})}},{key:"addProps",value:function(){this.setState((function(t){return{values:[].concat(Object(E.a)(t.values),[""])}}))}},{key:"removeProps",value:function(t){var e=Object(E.a)(this.state.values);e.splice(t,1),this.setState({values:e});var s=Object(E.a)(this.state.keys);s.splice(t,1),this.setState({keys:s})}},{key:"submitRunJob",value:function(){var t,e=this,s=[];for(t=0;t<this.state.keys.length;t++){var a,n=(a={},Object(S.a)(a,"$key$",this.state.keys[t]),Object(S.a)(a,"$value$",this.state.values[t]),a);s[t]=n}n="";this.runEtlJob(this.state.job_name.replace(/^"(.*)"$/,"$1"),s).then((function(t){var s=t.run_job;e.setNotification(!0);var a=JSON.parse(JSON.stringify(s));if(null!==a){n=JSON.stringify(a.props);var r=JSON.stringify(a.name);e.setJobDeails(r,n)}}))}},{key:"render",value:function(){var t=this,e="",s="",a="";return this.state.notification&&(s=this.state.run_job_props,this.state.is_error?(e="Error while submitting job!",JSON.parse(JSON.stringify(this.state.errors)).map((function(t){a=t.message}))):e=" Job "+this.state.job_name.replace(/^"(.*)"$/,"$1")+" submitted successfully! "),Object(O.jsxs)("div",{class:"container-fluid",children:[Object(O.jsx)("div",{children:Object(O.jsx)(I,{notification:this.state.notification,is_error:this.state.is_error,errors:a,message:e,job_props:s,setNotification:this.setNotification})}),Object(O.jsxs)("table",{id:"joblist",class:"table table-sm table-bordered",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Active/Inactive"}),Object(O.jsx)("th",{children:"Job Name"}),Object(O.jsx)("th",{children:"Schedule"}),Object(O.jsx)("th",{children:"Next Schedule"}),Object(O.jsx)("th",{children:"Schedule Remaining Time"}),Object(O.jsx)("th",{children:"Job Last Run"}),Object(O.jsx)("th",{children:"Job Last Time"}),Object(O.jsx)("th",{children:"Action"})]})}),Object(O.jsx)("tbody",{children:this.props.data.map((function(e){var s;return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:t.state.is_active&&e.is_active?Object(O.jsx)("div",{className:"checkbox",children:Object(O.jsx)("input",{type:"checkbox","aria-describedby":"UsernameHelp","data-toggle":"toggle",defaultChecked:!0,onClick:function(s){return t.updateJobActiveState(e.name,!1).then((function(e){e.update_job_state,t.props.get_etl_jobs(),t.setState((function(t){return{is_active:!1}}))}))}})}):Object(O.jsx)("div",{className:"checkbox",children:Object(O.jsx)("input",{type:"checkbox","aria-describedby":"UsernameHelp","data-toggle":"toggle",onClick:function(s){return t.updateJobActiveState(e.name,!0).then((function(e){e.update_job_state,t.props.get_etl_jobs(),t.setState((function(t){return{is_active:!0}}))}))}})})}),Object(O.jsxs)("td",{children:[" ",Object(O.jsx)("button",{type:"button",class:"btn btn-link","data-dismiss":"modal",onClick:function(){return t.handleOnClick(e.name)},children:e.name})]}),Object(O.jsx)("td",{children:e.schedule}),Object(O.jsx)("td",{children:e.nextSchedule}),Object(O.jsx)("td",{"data-order":e.nextSchedule,children:e.schduleRemainingTime}),Object(O.jsx)("td",{"data-order":e.last_run_time,children:0===e.last_run_time?Object(O.jsx)("div",{}):Object(O.jsx)("div",{children:e.last_run_description})}),Object(O.jsx)("td",{children:e.last_run_time}),Object(O.jsx)("td",{children:Object(O.jsx)("div",{class:"row",children:Object(O.jsxs)("div",(s={class:"col-xs-12 button-wrapper"},Object(S.a)(s,"class","inner"),Object(S.a)(s,"children",[Object(O.jsx)("button",{type:"button",class:"btn btn-secondary ml-2","data-toggle":"modal",onClick:function(){return t.showModal(e.props)},children:"Properties"}),Object(O.jsx)("div",{class:"modal fade",id:"jobListeModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})}),Object(O.jsxs)("div",{class:"inner",children:[Object(O.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return t.setState((function(t){return{job_name:e.name}}))},children:"Run"}),Object(O.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Run Job"}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsxs)("div",{class:"modal-body",children:[t.createUI(),Object(O.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Add Properties",onClick:t.addProps.bind(t)}),Object(O.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.submitRunJob()}})]}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})]),s))})})]})}))})]})]})}}]),s}(n.a.Component),P=Object(D.f)(T),V=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(o.a)(s,[{key:"render",value:function(){var t=Object(O.jsxs)("ul",{class:"pagination justify-content-center",children:[Object(O.jsx)(w,{call:this.props.get_etl_jobs})," "]});return""!==this.props.error?Object(O.jsxs)("div",{class:"container",children:[t,Object(O.jsx)(_,{status_code:this.props.error_code})]}):this.props.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsxs)("div",{class:"container-fluid",children:[t,Object(O.jsx)(P,{data:this.props.jobs})]})}}]),s}(n.a.Component),U=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setNotification=function(t){a.setState((function(e){return{notification:t}}))},a.job_run_id="",a.filterOperation=["IN","NOT IN"],a.state={retry_job_name:"",errors:[],is_error:!1,notification:!1,run_job_props:"",error:"",error_code:0},a}return Object(o.a)(s,[{key:"runEtlJob",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var a,n,r,i,c,o,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.getItem("Authorization"),a='\n      mutation {\n        run_job (name:"'.concat(e,'"){\n          name\n          props {key value}\n      }\n      }\n    '),s.length>0&&(n=[JSON.stringify(s).replaceAll('"$',"").replaceAll('$"',"")],a='\n      mutation {\n        run_job (name:"'.concat(e,'" ,props: ').concat(n,"){\n          name\n          props {key value}\n      }\n      }\n    ")),this.setState((function(t){return{loader:!0}})),t.next=6,f(m,a);case 6:if((r=t.sent).ok){t.next=13;break}throw i="An error has occured: ".concat(r.statusText),this.setState((function(t){return{error_code:r.status}})),new Error(i);case 13:return this.setState((function(t){return{loader:!1}})),t.next=16,r.json();case 16:return c=t.sent,o=c.data,l=c.errors,null!==JSON.parse(JSON.stringify(o.run_job))?this.setJobErrorDeails(!1):this.setJobErrorDeails(!0,JSON.parse(JSON.stringify(l))),t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"setJobErrorDeails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.fetchEtlFlowJobs()}),1e6)}))},{key:"showModal",value:function(t){var e="",s=JSON.parse(t);for(var a in s)e+="<b>"+a+"</b>="+s[a]+"<br></br>",F()("#jobRunModal .modal-body").html(e),F()("#jobRunModal").modal()}},{key:"retryJobRun",value:function(t,e){var s=this,a=[],n=JSON.parse(e),r=["job_send_slack_notification","job_enable_db_logging","job_notification_level"],i=0;a=[];for(var c in n){var o;if(!r.includes(c))a[i]=(o={},Object(S.a)(o,"$key$",c),Object(S.a)(o,"$value$",n[c]),o),i++}var l="";this.runEtlJob(t,a).then((function(t){var e=t.run_job;s.setNotification(!0);var a=JSON.parse(JSON.stringify(e));if(null!==a){l=JSON.stringify(a.props);var n=JSON.stringify(a.name);s.setJobDeails(n,l)}}))}},{key:"setJobDeails",value:function(t,e){this.setState((function(s){return{retry_job_name:t,run_job_props:e}}))}},{key:"showJobRunStateModal",value:function(t){F()("#jobRunStateModal .modal-body").html(t),F()("#jobRunStateModal").modal()}},{key:"handleOnClick",value:function(t){this.props.history.push("/JobRunDetails/"+t)}},{key:"render",value:function(){var t=this,e="",s="",a="",n="",r="",i="",c="",o="";return this.state.notification&&(o=this.state.run_job_props,this.state.is_error?(c="Error while submitting job!",JSON.parse(JSON.stringify(this.state.errors)).map((function(t){t.message}))):c=" Job "+this.state.retry_job_name.replace(/^"(.*)"$/,"$1")+" submitted successfully! "),e=0===this.props.paginationValue?Object(O.jsx)("li",{class:"page-item disabled",children:Object(O.jsx)("input",{type:"button",value:"Previous",class:"page-link btn btn-secondary btn-sm"})}):Object(O.jsx)("li",{class:"page-item",children:Object(O.jsx)("input",{type:"button",value:"Previous",class:"page-link btn btn-secondary btn-sm",onClick:function(){t.props.decPaginationValue(t.state.paginationValue-10)}})}),s=""!==this.props.filter?this.props.filter:"Add Filter",a=""!==this.props.job_name?this.props.job_name:"Type to search",n=""!==this.props.filter_start_date?this.props.filter_start_date:"Start Date",r=""!==this.props.filter_end_date?this.props.filter_end_date:"End Date",void 0!==this.props.match.params.job_name&&(i=Object(O.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.props.history.push("/")},children:"Back"})),Object(O.jsxs)("div",{className:"container-fluid",children:[Object(O.jsx)("div",{children:Object(O.jsx)(I,{notification:this.state.notification,is_error:this.state.is_error,errors:this.state.errors,message:c,job_props:o,setNotification:this.setNotification})}),Object(O.jsxs)("ul",{class:"pagination justify-content-center",children:[Object(O.jsxs)("div",{class:"dropdown",children:[Object(O.jsx)("button",{class:"btn btn-light dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:s}),Object(O.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(O.jsx)("a",{class:"dropdown-item",children:Object(O.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.props.setFilterName(e)},children:[" ",e," "]})})}))})]}),Object(O.jsxs)("div",{className:"form-inline float-right",children:[Object(O.jsx)("div",{className:"mb-1",children:Object(O.jsx)("input",{type:"text",className:"form-control input-sm",list:"datalistOptions",id:"exampleDataList",placeholder:a,onChange:function(e){return t.props.setJobName(document.getElementById("exampleDataList").value)}})}),Object(O.jsx)("datalist",{id:"datalistOptions",children:this.props.jobs.map((function(t){return Object(O.jsx)("option",{value:t.name})}))})]}),Object(O.jsxs)("div",{class:"form-inline float-right",children:[Object(O.jsx)("div",{class:"mb-1",children:Object(O.jsx)("input",{type:"date",className:"form-control input-sm",placeholder:n,id:"start_date",onChange:function(e){return t.props.setFilterStartDate(document.getElementById("start_date").value)}})}),Object(O.jsx)("div",{class:"mb-1",children:Object(O.jsx)("input",{type:"date",className:"form-control input-sm",placeholder:r,id:"end_date",onChange:function(e){return t.props.setFilterEndDate(document.getElementById("end_date").value)}})})]}),Object(O.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.props.setInitialState()},children:"Clear"}),i]}),Object(O.jsxs)("table",{id:"jobruns",class:"table table-sm table-bordered",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Job Name"}),Object(O.jsx)("th",{children:"Job Type"}),Object(O.jsx)("th",{children:"Job Start Time"}),Object(O.jsx)("th",{children:"Elapsed Time"}),Object(O.jsx)("th",{children:"Job Status"}),Object(O.jsx)("th",{children:"Actions"})]})}),Object(O.jsx)("tbody",{children:this.props.data.map((function(e){var s;return Object(O.jsxs)("tr",{children:[Object(O.jsxs)("td",{children:[" ",Object(O.jsx)("button",{type:"button",class:"btn btn-link","data-dismiss":"modal",onClick:function(){return t.handleOnClick(e.job_run_id)},children:e.job_name})]}),Object(O.jsx)("td",{children:e.job_type}),Object(O.jsx)("td",{children:e.start_time}),Object(O.jsx)("td",{children:e.elapsed_time}),Object(O.jsx)("td",{children:"pass"===e.state||""==e.state?Object(O.jsx)("div",{children:Object(O.jsx)("p",{className:"text-success",children:e.state})}):"started"===e.state||"running"==e.state?Object(O.jsx)("div",{children:Object(O.jsx)("p",{className:"text-warning",children:e.state})}):Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{type:"button",class:"btn btn-danger btn btn-sm","data-toggle":"modal",onClick:function(){return t.showJobRunStateModal(e.state)},children:"Error"}),Object(O.jsx)("div",{class:"modal fade",id:"jobRunStateModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})}),Object(O.jsx)("td",{children:Object(O.jsx)("div",{class:"row",children:Object(O.jsxs)("div",(s={class:"col-xs-12 button-wrapper"},Object(S.a)(s,"class","inner"),Object(S.a)(s,"children",[Object(O.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm ml-2","data-toggle":"modal",onClick:function(){return t.showModal(e.properties)},children:"Properties"}),Object(O.jsx)("div",{class:"modal fade",id:"jobRunModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})}),"pass"===e.state||""==e.state||"started"==e.state?Object(O.jsx)("div",{}):Object(O.jsx)("div",{class:"inner",children:Object(O.jsx)("button",{type:"button",class:"btn btn-warning btn-sm ml-2","data-toggle":"modal",onClick:function(){return t.retryJobRun(e.job_name,e.properties)},children:"Retry"})})]),s))})})]})}))})]}),Object(O.jsx)("nav",{"aria-label":"Page navigation example",children:Object(O.jsxs)("ul",{class:"pagination justify-content-center",children:[e,Object(O.jsx)("li",{class:"page-item",children:Object(O.jsx)("input",{type:"button",value:"Next",class:"page-link btn btn-secondary btn-sm",onClick:function(){t.props.incPaginationValue()}})})]})})]})}}]),s}(n.a.Component),q=Object(D.f)(U),B=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setJobRuns=function(t){var e=t||a.state.paginationValue;a.fetchEtlFlowJobs(e).then((function(t){var e=t.jobruns;a.setState((function(t){return{jobruns:e,loader:!1}}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={jobruns:[],job_name:"",filter:"",filter_start_date:"",filter_end_date:"",error:"",error_code:0,paginationValue:0},a.incPaginationValue=a.incPaginationValue.bind(Object(l.a)(a)),a.decPaginationValue=a.decPaginationValue.bind(Object(l.a)(a)),a.setJobName=a.setJobName.bind(Object(l.a)(a)),a.setFilterStartDate=a.setFilterStartDate.bind(Object(l.a)(a)),a.setFilterEndDate=a.setFilterEndDate.bind(Object(l.a)(a)),a.setInitialState=a.setInitialState.bind(Object(l.a)(a)),a.setFilterName=a.setFilterName.bind(Object(l.a)(a)),a}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(e){var s,a,n,r,i,c,o,l=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e,n=" query { jobruns(limit: ".concat(s=10," , offset: ").concat(a,"){ job_run_id job_name properties state start_time elapsed_time job_type is_master}}"),void 0!==this.props.match.params.job_name?(n=" query { jobruns(limit: ".concat(s," , offset: ").concat(a,' ,filter: "IN", jobName: "').concat(this.props.match.params.job_name,'"  )\n              { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'),""!==this.state.filter_end_date&&(n=" query { jobruns(limit: ".concat(s," , offset: ").concat(a,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'",filter: "IN", jobName: "').concat(this.props.match.params.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}')),this.setState((function(t){return{filter:"IN",job_name:l.props.match.params.job_name}}))):n=""!==this.state.filter_end_date&&""!==this.state.filter?" query { jobruns(limit: ".concat(s," , offset: ").concat(a,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'",filter: "').concat(this.state.filter,'", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""!==this.state.filter_end_date?" query { jobruns(limit: ".concat(s," , offset: ").concat(a,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'")\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""!==this.state.filter&&""!==this.state.job_name?" query { jobruns(limit: ".concat(s," , offset: ").concat(a,', filter: "').concat(this.state.filter,'", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""===this.state.filter&&""!==this.state.job_name?" query { jobruns(limit: ".concat(s," , offset: ").concat(a,' ,filter: "IN", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):" query { jobruns(limit: ".concat(s," , offset: ").concat(a,"){ job_run_id job_name  properties state start_time elapsed_time job_type is_master}}"),this.setState((function(t){return{loader:!0,error:""}})),t.next=7,f(m,n);case 7:if(403===(r=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),r.ok){t.next=15;break}throw i="An error has occured: ".concat(r.statusText),this.setState((function(t){return{error_code:r.status}})),new _(i);case 15:return this.setState((function(t){return{loader:!1}})),t.next=18,r.json();case 18:return c=t.sent,o=c.data,t.abrupt("return",o);case 21:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setJobName",value:function(t){this.setState((function(e){return{job_name:t}}))}},{key:"setFilterName",value:function(t){this.setState((function(e){return{filter:t}}))}},{key:"setFilterStartDate",value:function(t){this.setState((function(e){return{filter_start_date:t}}))}},{key:"setFilterEndDate",value:function(t){this.setState((function(e){return{filter_end_date:t}}))}},{key:"componentDidMount",value:function(){this.setJobRuns()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"incPaginationValue",value:function(){this.setState((function(t){return{paginationValue:t.paginationValue+10}})),this.setJobRuns(this.state.paginationValue+10)}},{key:"decPaginationValue",value:function(){var t=this;this.setState((function(t){return{paginationValue:t.paginationValue-10}}),(function(){return t.setJobRuns(t.state.paginationValue)}))}},{key:"setInitialState",value:function(){var t=this;this.props.match.params.job_name=void 0,this.setState((function(t){return{job_name:"",filter:"",filter_start_date:"",filter_end_date:"",paginationValue:0}}),(function(){return t.setJobRuns(0)}))}},{key:"render",value:function(){var t=Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsx)(w,{call:this.setJobRuns})});return""!==this.state.error?Object(O.jsxs)("div",{class:"container",children:[t,Object(O.jsx)(_,{status_code:this.state.error_code})]}):this.state.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsxs)("div",{className:"container-fluid",children:[t,Object(O.jsx)(q,{data:this.state.jobruns,jobs:this.props.jobs,setJobName:this.setJobName,setFilterStartDate:this.setFilterStartDate,setFilterEndDate:this.setFilterEndDate,setFilterName:this.setFilterName,incPaginationValue:this.incPaginationValue,decPaginationValue:this.decPaginationValue,setInitialState:this.setInitialState,job_name:this.state.job_name,filter:this.state.filter,filter_start_date:this.state.filter_start_date,filter_end_date:this.state.filter_end_date,paginationValue:this.state.paginationValue})]})}}]),s}(n.a.Component),z=Object(D.f)(B),$=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(){return Object(c.a)(this,s),e.apply(this,arguments)}return Object(o.a)(s,[{key:"showModal",value:function(t){var e="",s=JSON.parse(t);for(var a in s)e+="<b>"+a+"</b>="+s[a]+"<br></br>",F()("#queueStats .modal-body").html(e),F()("#queueStats").modal()}},{key:"render",value:function(){var t=this;return Object(O.jsx)("div",{class:"container",children:Object(O.jsxs)("table",{id:"joblist",class:"table table-sm table-bordered",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Job Name"}),Object(O.jsx)("th",{children:"Submitted From"}),Object(O.jsx)("th",{children:"Execution Time"}),Object(O.jsx)("th",{children:"Details"})]})}),Object(O.jsx)("tbody",{children:this.props.data.map((function(e){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:e.name}),Object(O.jsx)("td",{children:e.submitted_from}),Object(O.jsx)("td",{children:e.execution_time}),Object(O.jsxs)("td",{children:[Object(O.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm","data-toggle":"modal",onClick:function(){return t.showModal(e.details)},children:"Stats"}),Object(O.jsx)("div",{class:"modal fade",id:"queueStats",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})]},e.name)}))})]})})}}]),s}(n.a.Component),H=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).setEtlFlowQueueStats=function(){a.fetchEtlFlowQueueStats().then((function(t){var e=t.queueStats;a.setState((function(t){return{queueStats:e,loader:!1}}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={queueStats:[],loader:!1,error:"",error_code:0,errors:[]},a}return Object(o.a)(s,[{key:"fetchEtlFlowQueueStats",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState((function(t){return{loader:!0,error:""}}))," query { queueStats { name  details submitted_from execution_time  } }",t.next=4,f(m," query { queueStats { name  details submitted_from execution_time  } }");case 4:if(403===(e=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),e.ok){t.next=12;break}throw s="An error has occured: ".concat(e.statusText),this.setState((function(t){return{error_code:e.status}})),new _(s);case 12:return t.next=14,e.json();case 14:return a=t.sent,n=a.data,t.abrupt("return",n);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setJobErrorDeails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"componentDidMount",value:function(){this.setEtlFlowQueueStats()}},{key:"showModal",value:function(t){var e="",s=JSON.parse(t);for(var a in s)e+="<b>"+a+"</b>="+s[a]+"<br></br>",F()("#queueStats .modal-body").html(e),F()("#queueStats").modal()}},{key:"render",value:function(){var t=Object(O.jsx)("ul",{class:"pagination justify-content-center",children:Object(O.jsx)(w,{call:this.setEtlFlowQueueStats})});return""!==this.state.error?Object(O.jsxs)("div",{class:"container",children:[t,Object(O.jsx)(_,{status_code:this.state.error_code})]}):this.state.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsxs)("div",{children:[t,Object(O.jsx)($,{data:this.state.queueStats})]})}}]),s}(n.a.Component),Q=s(19),W=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).state={stepruns:[],loader:!1,error:"",error_code:0},a}return Object(o.a)(s,[{key:"fetchEtlFlowJobById",value:function(){var t=Object(h.a)(j.a.mark((function t(e){var s,a,n,r,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState((function(t){return{loader:!0}})),s=' query { stepruns(job_run_id: "'.concat(e,'"){ job_run_id step_name properties state start_time elapsed_time step_type step_run_id  } }'),t.next=4,f(m,s);case 4:if(403===(a=t.sent).status&&(this.props.logout(),localStorage.removeItem("Authorization")),a.ok){t.next=12;break}throw n="An error has occured: ".concat(a.statusText),this.setState((function(t){return{error_code:a.status}})),new _(n);case 12:return t.next=14,a.json();case 14:return r=t.sent,i=r.data,t.abrupt("return",i);case 17:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.fetchEtlFlowJobs()}),1e6)}))},{key:"componentDidMount",value:function(){this.setEtlFlowJobById(this.props.match.params.id),this.setInterval()}},{key:"setEtlFlowJobById",value:function(t){var e=this;this.fetchEtlFlowJobById(t).then((function(t){var s=t.stepruns;e.setState((function(t){return{stepruns:s,loader:!1}}))}))}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"showModal",value:function(t){var e="",s=JSON.parse(t);for(var a in s)e+="<b>"+a+"</b>="+s[a]+"<br></br>",F()("#stepRunModal .modal-body").html(e),F()("#stepRunModal").modal()}},{key:"showStepRunStateModal",value:function(t){F()("#stepRunStateModal .modal-body").html(t),F()("#stepRunStateModal").modal()}},{key:"handleOnClick",value:function(t){this.props.history.push("/StepRunsById/"+t)}},{key:"render",value:function(){var t=this,e=!1;this.state.stepruns.map((function(t){""!==t.step_run_id&&(e=!0)}));var s="";s=e?Object(O.jsx)("th",{children:"Linked Job"}):"";var a=["EtlFlowJobStep","DPSparkJobStep","ParallelETLStep"];return""!==this.state.error?Object(O.jsx)("div",{children:Object(O.jsx)(_,{error:this.state.error_code})}):this.state.loader?Object(O.jsx)("div",{children:Object(O.jsx)(C,{})}):Object(O.jsx)("div",{className:"container-fluid",children:Object(O.jsxs)("table",{id:"job runs",class:"table table-sm table-bordered",children:[Object(O.jsx)("thead",{class:"thead-dark",children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Job Run Id"}),Object(O.jsx)("th",{children:"Step Type"}),Object(O.jsx)("th",{children:"Step Name"}),Object(O.jsx)("th",{children:"Start Time"}),Object(O.jsx)("th",{children:"Elapsed Time"}),Object(O.jsx)("th",{children:"Status"}),Object(O.jsx)("th",{children:"Properties"}),s,Object(O.jsx)("th",{children:Object(O.jsx)("button",{className:"btn btn-secondary btn-block",onClick:function(){t.props.history.push("/JobRuns")},children:"Back"})})]})}),Object(O.jsx)("tbody",{children:this.state.stepruns.map((function(e){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:e.job_run_id}),Object(O.jsx)("td",{children:e.step_type}),Object(O.jsx)("td",{children:e.step_name}),Object(O.jsx)("td",{children:e.start_time}),Object(O.jsx)("td",{children:e.elapsed_time}),Object(O.jsx)("td",{children:"pass"===e.state||""==e.state?Object(O.jsx)("div",{children:Object(O.jsx)("p",{className:"text-success",children:e.state})}):"started"===e.state||"running"==e.state?Object(O.jsx)("div",{children:Object(O.jsx)("p",{className:"text-warning",children:e.state})}):Object(O.jsxs)("div",{children:[Object(O.jsx)("button",{type:"button",class:"btn btn-danger btn btn-sm","data-toggle":"modal",onClick:function(){return t.showStepRunStateModal(e.state)},children:"Error"}),Object(O.jsx)("div",{class:"modal fade",id:"stepRunStateModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})}),Object(O.jsxs)("td",{children:[Object(O.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm","data-toggle":"modal",onClick:function(){return t.showModal(e.properties)},children:"Properties"}),Object(O.jsx)("div",{class:"modal fade",id:"stepRunModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(O.jsx)("div",{class:"modal-dialog",role:"document",children:Object(O.jsxs)("div",{class:"modal-content",children:[Object(O.jsxs)("div",{class:"modal-header",children:[Object(O.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Step Properties"}),Object(O.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(O.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(O.jsx)("div",{class:"modal-body"}),Object(O.jsx)("div",{class:"modal-footer",children:Object(O.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]}),Object(O.jsx)("td",{children:a.includes(e.step_type)?Object(O.jsx)("input",{type:"button",value:"Check Progress",class:"btn btn-secondary btn-sm",onClick:function(){return t.setEtlFlowJobById(e.step_run_id)}}):Object(O.jsx)("div",{})})]})}))})]})})}}]),s}(n.a.Component),G=Object(D.f)(W),K=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).get_etl_jobs=function(){a.fetchEtlFlowJobs().then((function(t){var e=t.jobs;a.setState((function(t){return{jobs:e,loader:!1}}))})).catch((function(t){a.setState((function(e){return{error:t,loader:!1}}))}))},a.state={jobs:[],metrics:[],user:"",loader:!1,error:"",error_code:0},a}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,a,n;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState((function(t){return{loader:!0,error:""}}))," query { jobs { name  schedule props {key value} nextSchedule schduleRemainingTime is_active  last_run_time last_run_description } } ",t.next=4,f(m," query { jobs { name  schedule props {key value} nextSchedule schduleRemainingTime is_active  last_run_time last_run_description } } ");case 4:if(403===(e=t.sent).status&&(this.props.doLogout(),localStorage.removeItem("Authorization")),e.ok){t.next=12;break}throw s="An error has occured: ".concat(e.statusText),this.setState((function(t){return{error_code:e.status}})),new Error(s);case 12:return this.setState((function(t){return{loader:!1}})),t.next=15,e.json();case 15:return a=t.sent,n=a.data,t.abrupt("return",n);case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.get_etl_jobs()}),1e6)}))},{key:"fetchEtlFlowUserDetails",value:function(){var t=localStorage.getItem("Authorization"),e=JSON.parse(JSON.stringify(Object(p.a)(t)));this.setState({user:e.user})}},{key:"componentDidMount",value:function(){this.get_etl_jobs(),this.fetchEtlFlowUserDetails()}},{key:"remove_token",value:function(){localStorage.removeItem("Authorization"),this.props.doLogout("")}},{key:"render",value:function(){var t=this;return Object(O.jsxs)(Q.a,{children:[Object(O.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark mb-3",children:[Object(O.jsxs)("ul",{className:"nav navbar-nav w-100",children:[Object(O.jsxs)("li",{className:"nav-item nav-link",children:[Object(O.jsx)(Q.b,{to:"/",children:"Jobs"})," "]}),Object(O.jsxs)("li",{className:"nav-item nav-link",children:[Object(O.jsx)(Q.b,{to:"/JobRuns",children:"Job Runs"})," "]}),Object(O.jsxs)("li",{className:"nav-item nav-link",children:[Object(O.jsx)(Q.b,{to:"/RunningJobs",children:"Running Jobs"})," "]}),Object(O.jsxs)("li",{className:"nav-item nav-link",children:[Object(O.jsx)(Q.b,{to:"/Stats",children:"Stats"})," "]}),Object(O.jsxs)("li",{className:"nav-item nav-link",children:[Object(O.jsx)(Q.b,{to:"/Credentials",children:"Credentials"})," "]})]}),Object(O.jsx)("div",{class:"navbar-collapse collapse w-100 order-3 dual-collapse2",children:Object(O.jsxs)("ul",{class:"nav justify-content-end w-100",children:[Object(O.jsx)(x,{GRAPHQL_URL:this.props.GRAPHQL_URL}),Object(O.jsxs)("li",{class:"nav-item dropdown",children:[Object(O.jsx)("a",{class:"nav-link  dropdown-toggle",href:"#","data-toggle":"dropdown",children:this.state.user}),Object(O.jsxs)("ul",{class:"dropdown-menu",children:[Object(O.jsx)("li",{children:Object(O.jsx)("a",{class:"dropdown-item",href:"https://github.com/tharwaninitin/etlflow",children:"Git Hub"})}),Object(O.jsx)("li",{children:Object(O.jsx)("a",{class:"dropdown-item",href:"https://tharwaninitin.github.io/etlflow/site/",children:"Docs"})}),Object(O.jsx)("li",{children:Object(O.jsx)("a",{class:"dropdown-item",children:Object(O.jsx)("input",{type:"button",class:"btn btn-secondary btn-sm",value:"LogOut",onClick:function(){return t.remove_token()}})})})]})]})]})})]}),Object(O.jsxs)(D.c,{children:[Object(O.jsx)(D.a,{exact:!0,path:"/",component:function(){return Object(O.jsx)(V,{jobs:t.state.jobs,logout:t.props.doLogout,get_etl_jobs:t.get_etl_jobs,error:t.state.error,error_code:t.state.error_code,loader:t.state.loader})}}),Object(O.jsx)(D.a,{path:"/JobRuns/:job_name?",render:function(e){return Object(O.jsx)(z,{logout:t.props.doLogout,jobs:t.state.jobs})}}),Object(O.jsx)(D.a,{path:"/RunningJobs",render:function(e){return Object(O.jsx)(H,{logout:t.props.doLogout})}}),Object(O.jsx)(D.a,{path:"/Stats",render:function(e){return Object(O.jsx)(M,{logout:t.props.doLogout})}}),Object(O.jsx)(D.a,{path:"/Credentials",render:function(e){return Object(O.jsx)(A,{logout:t.props.doLogout})}}),Object(O.jsx)(D.a,{path:"/JobRunDetails/:id",render:function(t){return Object(O.jsx)(G,{})}})]})]})}}]),s}(n.a.Component),X=(s(46),s(47),s(48),function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).state={user_name:"",password:"",token:"",login:[]},a.login_validation=a.login_validation.bind(Object(l.a)(a)),a.set_login_user_name=a.set_login_user_name.bind(Object(l.a)(a)),a.set_login_password=a.set_login_password.bind(Object(l.a)(a)),a}return Object(o.a)(s,[{key:"fetchLoginDetails",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var a,n,r,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=' mutation { login (user_name: "'.concat(e,'", password: "').concat(s,'") { message token } }'),t.next=3,f("/api/login",a);case 3:return n=t.sent,t.next=6,n.json();case 6:return r=t.sent,i=r.data,t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"login_validation",value:function(){var t=this;this.fetchLoginDetails(this.state.user_name,this.state.password).then((function(e){var s=e.login,a=JSON.parse(JSON.stringify(s)).token;""!==a?(localStorage.setItem("Authorization",a),t.props.doLogin(a),t.setState((function(t){return{token:a}}))):alert("Invalid User")}))}},{key:"set_login_user_name",value:function(){this.setState((function(t){return{user_name:document.getElementById("user_name").value}}))}},{key:"set_login_password",value:function(){this.setState((function(t){return{password:document.getElementById("password").value}}))}},{key:"render",value:function(){var t=this;return Object(O.jsxs)("div",{className:"main",align:"center",children:[Object(O.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark mb-3",children:Object(O.jsx)("ul",{className:"nav navbar-nav w-50",children:Object(O.jsx)("li",{className:"nav-item nav-link",children:"EtlFlow"})})}),Object(O.jsx)("div",{className:"col-md-3",children:Object(O.jsx)("div",{className:"login-form ",children:Object(O.jsxs)("form",{id:"form_login",className:"text-center border border-dark p-5",onSubmit:function(e){t.login_validation(),e.preventDefault()},children:[Object(O.jsx)("p",{className:"h4 mb-4",children:"EtlFlow Login"}),Object(O.jsx)("div",{className:"form-group",children:Object(O.jsx)("input",{type:"text",className:"form-control","aria-describedby":"UsernameHelp",placeholder:"Username",id:"user_name",onChange:function(e){return t.set_login_user_name()}})}),Object(O.jsx)("div",{className:"form-group",children:Object(O.jsx)("input",{type:"password",className:"form-control","aria-describedby":"PasswordHelp",placeholder:"Password",id:"password",onChange:function(e){return t.set_login_password()}})}),Object(O.jsx)("button",{type:"submit",className:"btn btn-secondary btn-block",children:"Submit"})]})})})]})}}]),s}(n.a.Component)),Y=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var a;return Object(c.a)(this,s),(a=e.call(this,t)).state={token:""},a.doLogin=a.doLogin.bind(Object(l.a)(a)),a.doLogout=a.doLogout.bind(Object(l.a)(a)),a}return Object(o.a)(s,[{key:"doLogin",value:function(t,e){this.setState({token:t})}},{key:"doLogout",value:function(t){this.setState({token:""})}},{key:"render",value:function(){return null===localStorage.getItem("Authorization")?Object(O.jsx)("div",{children:Object(O.jsx)(X,{GRAPHQL_LOGIN_URL:this.GRAPHQL_LOGIN_URL,doLogin:this.doLogin})}):Object(O.jsx)("div",{children:Object(O.jsx)(K,{GRAPHQL_URL:this.GRAPHQL_URL,doLogout:this.doLogout})})}}]),s}(n.a.Component);i.a.render(Object(O.jsx)(n.a.StrictMode,{children:Object(O.jsx)(Y,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.9b2263d7.chunk.js.map