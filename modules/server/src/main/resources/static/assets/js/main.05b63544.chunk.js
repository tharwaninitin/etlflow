(this["webpackJsonpetlflow-updated"]=this["webpackJsonpetlflow-updated"]||[]).push([[0],{29:function(t,e,s){},53:function(t,e){},54:function(t,e,s){"use strict";s.r(e);var n=s(1),a=s.n(n),i=s(38),r=s.n(i),c=s(5),o=s(6),l=s(18),d=s(8),u=s(7),b=s(2),j=s.n(b),h=s(4),p=s(10),m=s(17),f=(s(15),s(16),s(19),s(29),s(3)),O=(s(20),s(21),s(9)),x=s.n(O),_=s(0),v=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={jobs:[],notification:!1,run_job_props:"",job_name:"",errors:[],is_error:!1,is_active:!0,values:[],keys:[]},n}return Object(o.a)(s,[{key:"updateJobActiveState",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var n,a,i,r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",n=localStorage.getItem("Authorization"),t.next=4,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:n},body:JSON.stringify({query:'\n            mutation {\n              update_job_state (name:"'.concat(e,'" ,state: ').concat(s,"){\n             }\n           }\n          ")})});case 4:return 403===(a=t.sent).status&&localStorage.removeItem("Authorization"),t.next=8,a.json();case 8:return i=t.sent,r=i.data,t.abrupt("return",r);case 11:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"run_etl_job",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var n,a,i,r,c,o,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",n=localStorage.getItem("Authorization"),a='\n      mutation {\n        run_job (name:"'.concat(e,'"){\n          name\n          props {key value}\n      }\n      }\n    '),s.length>0&&(i=JSON.stringify(s).replaceAll('"$',"").replaceAll('$"',""),a='\n      mutation {\n        run_job (name:"'.concat(e,'" ,props: ').concat(i,"){\n          name\n          props {key value}\n      }\n      }\n    ")),this.setState((function(t){return{loader:!0}})),t.next=7,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:n},body:JSON.stringify({query:a})});case 7:return 403===(r=t.sent).status&&this.props.logout(),this.setState((function(t){return{loader:!0}})),t.next=12,r.json();case 12:return c=t.sent,o=c.data,l=c.errors,null!==JSON.parse(JSON.stringify(o.run_job))?this.set_job_error_deails(!1):this.set_job_error_deails(!0,JSON.parse(JSON.stringify(l))),t.abrupt("return",o);case 17:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=x()("#joblist").DataTable({order:[[6,"desc"]]});t.column(6).visible(!1),t.column(3).visible(!1)}},{key:"show_modal",value:function(t){var e="";t.map((function(t){return e+="<b>"+t.key+"</b>="+t.value+"<br></br>"})),x()("#jobListeModal .modal-body").html(e),x()("#jobListeModal").modal()}},{key:"set_notification",value:function(t){this.setState((function(e){return{notification:t}}))}},{key:"set_job_deails",value:function(t,e){this.setState((function(s){return{job_name:t,run_job_props:e}}))}},{key:"set_job_error_deails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"handleOnClick",value:function(t){this.props.history.push("/JobRuns/"+t)}},{key:"create_ui",value:function(){var t=this;return this.state.values.map((function(e,s){return Object(_.jsx)("div",{children:Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",value:t.state.keys[s],type:"text",placeholder:"Type Key",onChange:t.set_run_job_keys.bind(t,s)})})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",value:e||"",type:"text",placeholder:"Type Value",onChange:t.set_run_job_values.bind(t,s)})})}),Object(_.jsx)("div",{class:"col-xs-3",children:Object(_.jsx)("input",{type:"button",class:"btn btn-danger",value:"-",onClick:t.remove_props.bind(t,s)})})]})},s)}))}},{key:"set_run_job_values",value:function(t,e){var s=Object(m.a)(this.state.values);s[t]=e.target.value,this.setState({values:s})}},{key:"set_run_job_keys",value:function(t,e){var s=Object(m.a)(this.state.keys);s[t]=e.target.value,this.setState({keys:s})}},{key:"add_props",value:function(){this.setState((function(t){return{values:[].concat(Object(m.a)(t.values),[""])}}))}},{key:"remove_props",value:function(t){var e=Object(m.a)(this.state.values);e.splice(t,1),this.setState({values:e});var s=Object(m.a)(this.state.keys);s.splice(t,1),this.setState({keys:s})}},{key:"submit_run_job",value:function(t){var e,s=this,n=[];for(e=0;e<this.state.keys.length;e++){var a,i=(a={},Object(p.a)(a,"$key$",this.state.keys[e]),Object(p.a)(a,"$value$",this.state.values[e]),a);n[e]=i}i="";this.run_etl_job(this.state.job_name,n).then((function(t){var e=t.run_job;s.set_notification(!0);var n=JSON.parse(JSON.stringify(e));if(null!==n){i=JSON.stringify(n.props);var a=JSON.stringify(n.name);s.set_job_deails(a,i)}}))}},{key:"render",value:function(){var t=this,e="";return this.state.notification&&(e=this.state.is_error?Object(_.jsxs)("div",{class:"alert alert-danger alert-dismissible fade show",role:"alert",children:[Object(_.jsx)("h4",{class:"alert-heading",children:"Error while submitting job!"}),Object(_.jsx)("p",{children:JSON.parse(JSON.stringify(this.state.errors)).map((function(t){return t.message}))}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}):Object(_.jsxs)("div",{class:"alert alert-success alert-dismissible fade show",role:"alert",children:[Object(_.jsxs)("h4",{class:"alert-heading",children:["Job ",this.state.job_name.replace(/^"(.*)"$/,"$1")," submitted successfully!  "]}),Object(_.jsx)("p",{children:this.state.run_job_props}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})),Object(_.jsxs)("div",{class:"container-fluid",children:[Object(_.jsx)("div",{children:e}),Object(_.jsx)("ul",{class:"pagination justify-content-center",children:Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.props.get_etl_jobs()},children:"Refresh"})}),Object(_.jsxs)("table",{id:"joblist",class:"table table-sm table-bordered",children:[Object(_.jsx)("thead",{class:"thead-dark",children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Active/Inactive"}),Object(_.jsx)("th",{children:"Job Name"}),Object(_.jsx)("th",{children:"Schedule"}),Object(_.jsx)("th",{children:"Next Schedule"}),Object(_.jsx)("th",{children:"Schedule Remaining Time"}),Object(_.jsx)("th",{children:"Job Last Run"}),Object(_.jsx)("th",{children:"Job Last Time"}),Object(_.jsx)("th",{children:"Action"})]})}),Object(_.jsx)("tbody",{children:this.props.jobs.map((function(e){var s;return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:t.state.is_active&&e.is_active?Object(_.jsx)("div",{className:"checkbox",children:Object(_.jsx)("input",{type:"checkbox","aria-describedby":"UsernameHelp","data-toggle":"toggle",defaultChecked:!0,onClick:function(s){return t.updateJobActiveState(e.name,!1).then((function(e){e.update_job_state,t.props.get_etl_jobs(),t.setState((function(t){return{is_active:!1}}))}))}})}):Object(_.jsx)("div",{className:"checkbox",children:Object(_.jsx)("input",{type:"checkbox","aria-describedby":"UsernameHelp","data-toggle":"toggle",onClick:function(s){return t.updateJobActiveState(e.name,!0).then((function(e){e.update_job_state,t.props.get_etl_jobs(),t.setState((function(t){return{is_active:!0}}))}))}})})}),Object(_.jsxs)("td",{children:[" ",Object(_.jsx)("button",{type:"button",class:"btn btn-link","data-dismiss":"modal",onClick:function(){return t.handleOnClick(e.name)},children:e.name})]}),Object(_.jsx)("td",{children:e.schedule}),Object(_.jsx)("td",{children:e.nextSchedule}),Object(_.jsx)("td",{"data-order":e.nextSchedule,children:e.schduleRemainingTime}),Object(_.jsx)("td",{"data-order":e.last_run_time,children:0===e.last_run_time?Object(_.jsx)("div",{}):Object(_.jsx)("div",{children:e.last_run_description})}),Object(_.jsx)("td",{children:e.last_run_time}),Object(_.jsx)("td",{children:Object(_.jsx)("div",{class:"row",children:Object(_.jsxs)("div",(s={class:"col-xs-12 button-wrapper"},Object(p.a)(s,"class","inner"),Object(p.a)(s,"children",[Object(_.jsx)("button",{type:"button",class:"btn btn-secondary ml-2","data-toggle":"modal",onClick:function(){return t.show_modal(e.props)},children:"Properties"}),Object(_.jsx)("div",{class:"modal fade",id:"jobListeModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})}),Object(_.jsxs)("div",{class:"inner",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return t.setState((function(t){return{job_name:e.name}}))},children:"Run"}),Object(_.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Run Job"}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsxs)("div",{class:"modal-body",children:[t.create_ui(),Object(_.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Add Properties",onClick:t.add_props.bind(t)}),Object(_.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.submit_run_job()}})]}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})]),s))})})]})}))})]})]})}}]),s}(a.a.Component),y=Object(f.f)(v),g=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){return Object(c.a)(this,s),e.call(this,t)}return Object(o.a)(s,[{key:"render",value:function(){return Object(_.jsx)("div",{class:"d-flex justify-content-center",children:Object(_.jsx)("div",{class:"spinner-border m-5",role:"status",children:Object(_.jsx)("span",{class:"sr-only",children:"Loading..."})})})}}]),s}(a.a.Component),k=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).job_run_id="",n.filterOperation=["IN","NOT IN"],n.state={jobruns:[],filter:"",job_name:"",filter_start_date:"",filter_end_date:"",paginationValue:0,loader:!1,errors:[],is_error:!1,notification:!1,run_job_props:""},n}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a,i,r,c,o=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),s=10,n=this.state.paginationValue,a=" query { jobruns(limit: ".concat(s," , offset: ").concat(n,"){ job_run_id job_name properties state start_time elapsed_time job_type is_master}}"),void 0!==this.props.match.params.job_name?(a=" query { jobruns(limit: ".concat(s," , offset: ").concat(n,' ,filter: "IN", jobName: "').concat(this.props.match.params.job_name,'"  )\n              { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'),""!==this.state.filter_end_date&&(a=" query { jobruns(limit: ".concat(s," , offset: ").concat(n,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'",filter: "IN", jobName: "').concat(this.props.match.params.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}')),this.setState((function(t){return{filter:"IN",job_name:o.props.match.params.job_name}}))):a=""!==this.state.filter_end_date&&""!==this.state.filter?" query { jobruns(limit: ".concat(s," , offset: ").concat(n,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'",filter: "').concat(this.state.filter,'", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""!==this.state.filter_end_date?" query { jobruns(limit: ".concat(s," , offset: ").concat(n,',  startTime: "').concat(this.state.filter_start_date,'", endTime: "').concat(this.state.filter_end_date,'")\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""!==this.state.filter&&""!==this.state.job_name?" query { jobruns(limit: ".concat(s," , offset: ").concat(n,', filter: "').concat(this.state.filter,'", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):""===this.state.filter&&""!==this.state.job_name?" query { jobruns(limit: ".concat(s," , offset: ").concat(n,' ,filter: "IN", jobName: "').concat(this.state.job_name,'"  )\n        { job_run_id job_name  properties state start_time elapsed_time job_type is_master}}'):" query { jobruns(limit: ".concat(s," , offset: ").concat(n,"){ job_run_id job_name  properties state start_time elapsed_time job_type is_master}}"),this.setState((function(t){return{loader:!0}})),t.next=9,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:a})});case 9:return 403===(i=t.sent).status&&this.props.logout(),t.next=13,i.json();case 13:return r=t.sent,c=r.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",c);case 17:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"run_etl_job",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var n,a,i,r,c,o,l;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",n=localStorage.getItem("Authorization"),a='\n      mutation {\n        run_job (name:"'.concat(e,'"){\n          name\n          props {key value}\n      }\n      }\n    '),s.length>0&&(i=[JSON.stringify(s).replaceAll('"$',"").replaceAll('$"',"")],a='\n      mutation {\n        run_job (name:"'.concat(e,'" ,props: ').concat(i,"){\n          name\n          props {key value}\n      }\n      }\n    ")),this.setState((function(t){return{loader:!0}})),t.next=7,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:n},body:JSON.stringify({query:a})});case 7:return 403===(r=t.sent).status&&localStorage.removeItem("Authorization"),this.setState((function(t){return{loader:!1}})),t.next=12,r.json();case 12:return c=t.sent,o=c.data,l=c.errors,null!==JSON.parse(JSON.stringify(o.run_job))?this.set_job_error_deails(!1):this.set_job_error_deails(!0,JSON.parse(JSON.stringify(l))),t.abrupt("return",o);case 17:case"end":return t.stop()}}),t,this)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"set_job_error_deails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.fetchEtlFlowJobs()}),1e6)}))},{key:"componentDidMount",value:function(){this.set_jobruns(),this.setInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"set_jobruns",value:function(){var t=this;this.fetchEtlFlowJobs().then((function(e){var s=e.jobruns;t.setState((function(t){return{jobruns:s}}))}))}},{key:"set_job_name",value:function(){this.setState((function(t){return{job_name:document.getElementById("exampleDataList").value}}))}},{key:"set_filter_start_date",value:function(){this.setState((function(t){return{filter_start_date:document.getElementById("start_date").value}}))}},{key:"set_filter_end_date",value:function(){this.setState((function(t){return{filter_end_date:document.getElementById("end_date").value}}))}},{key:"show_modal",value:function(t){var e="",s=JSON.parse(t);for(var n in s)e+="<b>"+n+"</b>="+s[n]+"<br></br>",x()("#jobRunModal .modal-body").html(e),x()("#jobRunModal").modal()}},{key:"retry_job_run",value:function(t,e){var s=this,n=[],a=JSON.parse(e),i=["job_send_slack_notification","job_enable_db_logging","job_notification_level"],r=0;n=[];for(var c in a){var o;if(!i.includes(c))n[r]=(o={},Object(p.a)(o,"$key$",c),Object(p.a)(o,"$value$",a[c]),o),r++}var l="";this.run_etl_job(t,n).then((function(t){var e=t.run_job;s.set_notification(!0);var n=JSON.parse(JSON.stringify(e));if(null!==n){l=JSON.stringify(n.props);var a=JSON.stringify(n.name);s.set_job_deails(a,l)}}))}},{key:"set_job_deails",value:function(t,e){this.setState((function(s){return{job_name:t,run_job_props:e}}))}},{key:"set_notification",value:function(t){this.setState((function(e){return{notification:t}}))}},{key:"set_initial_state",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.props.match.params.job_name=void 0,this.setState((function(t){return{filter:"",job_name:"",filter_start_date:"",filter_end_date:"",paginationValue:0}}),(function(){return e.set_jobruns()}));case 2:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"show_job_run_state_modal",value:function(t){x()("#jobRunStateModal .modal-body").html(t),x()("#jobRunStateModal").modal()}},{key:"handleOnClick",value:function(t){this.props.history.push("/JobRunDetails/"+t)}},{key:"render",value:function(){var t=this,e="",s="",n="",a="",i="",r="",c="";return this.state.notification&&(c=this.state.is_error?Object(_.jsxs)("div",{class:"alert alert-danger alert-dismissible fade show",role:"alert",children:[Object(_.jsx)("h4",{class:"alert-heading",children:"Error while submitting job!"}),Object(_.jsx)("p",{children:JSON.parse(JSON.stringify(this.state.errors)).map((function(t){return t.message}))}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}):Object(_.jsxs)("div",{class:"alert alert-success alert-dismissible fade show",role:"alert",children:[Object(_.jsxs)("h4",{class:"alert-heading",children:["Job ",this.state.job_name.replace(/^"(.*)"$/,"$1")," submitted successfully!  "]}),Object(_.jsx)("p",{children:this.state.run_job_props}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})),e=0===this.state.paginationValue?Object(_.jsx)("li",{class:"page-item disabled",children:Object(_.jsx)("input",{type:"button",value:"Previous",class:"page-link btn btn-secondary btn-sm"})}):Object(_.jsx)("li",{class:"page-item",children:Object(_.jsx)("input",{type:"button",value:"Previous",class:"page-link btn btn-secondary btn-sm",onClick:function(){t.setState((function(e){return{paginationValue:t.state.paginationValue-10}})),t.fetchEtlFlowJobs(t.state.paginationValue-10).then((function(e){var s=e.jobruns;t.setState((function(t){return{jobruns:s}}))}))}})}),s=""!==this.state.filter?this.state.filter:"Add Filter",n=""!==this.state.job_name?this.state.job_name:"Type to search",a=""!==this.state.filter_start_date?this.state.filter_start_date:"Start Date",i=""!==this.state.filter_end_date?this.state.filter_end_date:"End Date",void 0!==this.props.match.params.job_name&&(r=Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.props.history.push("/")},children:"Back"})),this.state.loader?Object(_.jsx)("div",{children:Object(_.jsx)(g,{})}):Object(_.jsxs)("div",{className:"container-fluid",children:[Object(_.jsx)("h3",{children:this.state.loader}),Object(_.jsx)("div",{children:c}),Object(_.jsxs)("ul",{class:"pagination justify-content-center",children:[Object(_.jsxs)("div",{class:"dropdown",children:[Object(_.jsx)("button",{class:"btn btn-light dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:s}),Object(_.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(_.jsx)("a",{class:"dropdown-item",children:Object(_.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{filter:e}}))},children:[" ",e," "]})})}))})]}),Object(_.jsxs)("div",{className:"form-inline float-right",children:[Object(_.jsx)("div",{className:"mb-1",children:Object(_.jsx)("input",{type:"text",className:"form-control input-sm",list:"datalistOptions",id:"exampleDataList",placeholder:n,onChange:function(e){return t.set_job_name()}})}),Object(_.jsx)("datalist",{id:"datalistOptions",children:this.props.jobs.map((function(t){return Object(_.jsx)("option",{value:t.name})}))})]}),Object(_.jsxs)("div",{class:"form-inline float-right",children:[Object(_.jsx)("div",{class:"mb-1",children:Object(_.jsx)("input",{type:"date",className:"form-control input-sm",placeholder:a,id:"start_date",onChange:function(e){return t.set_filter_start_date()}})}),Object(_.jsx)("div",{class:"mb-1",children:Object(_.jsx)("input",{type:"date",className:"form-control input-sm",placeholder:i,id:"end_date",onChange:function(e){return t.set_filter_end_date()}})})]}),Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.set_initial_state()},children:"Clear"}),Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.set_jobruns()},children:"Refresh"}),r]}),Object(_.jsxs)("table",{id:"jobruns",class:"table table-sm table-bordered",children:[Object(_.jsx)("thead",{class:"thead-dark",children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Job Name"}),Object(_.jsx)("th",{children:"Job Type"}),Object(_.jsx)("th",{children:"Job Start Time"}),Object(_.jsx)("th",{children:"Elapsed Time"}),Object(_.jsx)("th",{children:"Job Status"}),Object(_.jsx)("th",{children:"Actions"})]})}),Object(_.jsx)("tbody",{children:this.state.jobruns.map((function(e){var s;return Object(_.jsxs)("tr",{children:[Object(_.jsxs)("td",{children:[" ",Object(_.jsx)("button",{type:"button",class:"btn btn-link","data-dismiss":"modal",onClick:function(){return t.handleOnClick(e.job_run_id)},children:e.job_name})]}),Object(_.jsx)("td",{children:e.job_type}),Object(_.jsx)("td",{children:e.start_time}),Object(_.jsx)("td",{children:e.elapsed_time}),Object(_.jsx)("td",{children:"pass"===e.state||""==e.state?Object(_.jsx)("div",{children:Object(_.jsx)("p",{className:"text-success",children:e.state})}):"started"===e.state||"running"==e.state?Object(_.jsx)("div",{children:Object(_.jsx)("p",{className:"text-warning",children:e.state})}):Object(_.jsxs)("div",{children:[Object(_.jsx)("button",{type:"button",class:"btn btn-danger btn btn-sm","data-toggle":"modal",onClick:function(){return t.show_job_run_state_modal(e.state)},children:"Error"}),Object(_.jsx)("div",{class:"modal fade",id:"jobRunStateModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})}),Object(_.jsx)("td",{children:Object(_.jsx)("div",{class:"row",children:Object(_.jsxs)("div",(s={class:"col-xs-12 button-wrapper"},Object(p.a)(s,"class","inner"),Object(p.a)(s,"children",[Object(_.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm ml-2","data-toggle":"modal",onClick:function(){return t.show_modal(e.properties)},children:"Properties"}),Object(_.jsx)("div",{class:"modal fade",id:"jobRunModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})}),"pass"===e.state||""==e.state||"started"==e.state?Object(_.jsx)("div",{}):Object(_.jsx)("div",{class:"inner",children:Object(_.jsx)("button",{type:"button",class:"btn btn-warning btn-sm ml-2","data-toggle":"modal",onClick:function(){return t.retry_job_run(e.job_name,e.properties)},children:"Retry"})})]),s))})})]})}))})]}),Object(_.jsx)("nav",{"aria-label":"Page navigation example",children:Object(_.jsxs)("ul",{class:"pagination justify-content-center",children:[e,Object(_.jsx)("li",{class:"page-item",children:Object(_.jsx)("input",{type:"button",value:"Next",class:"page-link btn btn-secondary btn-sm",onClick:function(){t.setState((function(e){return{paginationValue:t.state.paginationValue+10}})),t.fetchEtlFlowJobs(t.state.paginationValue+10).then((function(e){var s=e.jobruns;t.setState((function(t){return{jobruns:s}}))}))}})})]})})]})}}]),s}(a.a.Component),w=Object(f.f)(k),S=(a.a.Component,function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={queueStats:[],loader:!1},n}return Object(o.a)(s,[{key:"fetchEtlFlowQueueStats",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),this.setState((function(t){return{loader:!0}})),t.next=5,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:"\n          query {\n            queueStats {\n              name \n              details\n              submitted_from\n              execution_time\n              }\n           }\n          "})});case 5:return 403===(s=t.sent).status&&this.props.logout(),t.next=9,s.json();case 9:return n=t.sent,a=n.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=this;this.fetchEtlFlowQueueStats().then((function(e){var s=e.queueStats;t.setState((function(t){return{queueStats:s}}))}))}},{key:"show_modal",value:function(t){var e="",s=JSON.parse(t);for(var n in s)e+="<b>"+n+"</b>="+s[n]+"<br></br>",x()("#queueStats .modal-body").html(e),x()("#queueStats").modal()}},{key:"render",value:function(){var t=this;return this.state.loader?Object(_.jsx)("div",{children:Object(_.jsx)(g,{job_run_id:this.job_run_id,set_job_run_state:this.set_job_run_state})}):Object(_.jsxs)("div",{class:"container",children:[Object(_.jsx)("ul",{class:"pagination justify-content-center",children:Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.fetchEtlFlowQueueStats().then((function(e){var s=e.queueStats;t.setState((function(t){return{queueStats:s}}))}))},children:"Refresh"})}),Object(_.jsxs)("table",{id:"joblist",class:"table table-sm table-bordered",children:[Object(_.jsx)("thead",{class:"thead-dark",children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Job Name"}),Object(_.jsx)("th",{children:"Submitted From"}),Object(_.jsx)("th",{children:"Execution Time"}),Object(_.jsx)("th",{children:"Details"})]})}),Object(_.jsx)("tbody",{children:this.state.queueStats.map((function(e){return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:e.name}),Object(_.jsx)("td",{children:e.submitted_from}),Object(_.jsx)("td",{children:e.execution_time}),Object(_.jsxs)("td",{children:[Object(_.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm","data-toggle":"modal",onClick:function(){return t.show_modal(e.details)},children:"Stats"}),Object(_.jsx)("div",{class:"modal fade",id:"queueStats",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})]})}))})]})]})}}]),s}(a.a.Component)),C=Object(f.f)(S),N=s(33),J=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={currentime:""},n}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),t.next=4,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:"\n          query {\n            currentime {\n                current_time\n             }\n           }\n          "})});case 4:return s=t.sent,t.next=7,s.json();case 7:return n=t.sent,a=n.data,t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=this;this.fetchEtlFlowJobs().then((function(e){var s=e.currentime;t.setState((function(t){return{currentime:s.current_time}}))}))}},{key:"render",value:function(){return Object(_.jsx)("li",{className:"nav-item",children:Object(_.jsx)("a",{className:"nav-link disabled",children:this.state.currentime})})}}]),s}(a.a.Component),M=(s(37),s(32),s(52),s(23)),L=s.n(M),A=new URL("/ws/etlflow",window.location.href);A.protocol=A.protocol.replace("http","ws");var I=new WebSocket(A+"/"+localStorage.getItem("Authorization")),T=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;Object(c.a)(this,s),(n=e.call(this,t)).addMessage=function(t){return n.setState((function(e){return{messages:t}}))};return n.state={used:"",total:"",free:"",max:"",jobLogs:[],filter:"",limit:"",metrics:[]},n.filterOperation=["2","5","10"],n.limitOperation=["2","5","10","30","50"],n.options={low:0,showArea:!0,showPoint:!1},n}return Object(o.a)(s,[{key:"call_api",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),s=" query { jobLogs { job_name success failed }}",""!==this.state.filter&&""!==this.state.limit?s=" query { jobLogs(limit: ".concat(this.state.limit,", filter: ").concat(this.state.filter,"  ) { job_name success failed }}"):""!==this.state.filter?s=" query { jobLogs(filter: ".concat(this.state.filter,") { job_name success failed }}"):""!==this.state.limit&&(s=" query { jobLogs(limit: ".concat(this.state.limit,") { job_name success failed }}")),t.next=6,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:s})});case 6:return 403===(n=t.sent).status&&this.props.logout(),t.next=10,n.json();case 10:return a=t.sent,i=a.data,t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"fetchEtlFlowMetrics",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),this.setState((function(t){return{loader:!0}})),t.next=5,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:"\n          query {\n            metrics {\n                active_jobs\n                active_subscribers\n                etl_jobs\n                cron_jobs\n                build_time\n              }\n           }\n          "})});case 5:return 403===(s=t.sent).status&&this.props.logout(),t.next=9,s.json();case 9:return n=t.sent,a=n.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"call",value:function(t){var e=this;if("true"===t)I.close(1e3,"User closed the connection"),document.getElementById("statslinknotify").innerText="Real-Time Stats (Offline)",this.setState((function(t){return{messages:[]}})),console.log("ws closed");else{document.getElementById("statslinknotify").innerText="Real-Time Stats (Online)",(I=new WebSocket(A+"/"+localStorage.getItem("Authorization"))).onopen=function(){console.log("ws connected")},I.onmessage=function(t){var s=t.data,n=JSON.parse(s).memory;e.setState((function(t){return{used:n.used,total:n.total,free:n.free,max:n.max}}))},I.onclose=function(){console.log("disconnected")};var s={series:[[]]},n={series:[[]]},a={series:[[]]},i=new L.a.Line(".ct-chart",s,this.options),r=new L.a.Line(".cpu-chart",n,this.options),c=new L.a.Line(".cpu-chart-1",a,this.options);this.updateUsedMemoryChart(i,s,this.getUsedMemoryData(),30),this.updateFreeMemoryChart(r,n,this.getFreeMemoryData(),30),this.updateTotalMemoryChart(c,a,this.getTotalMemoryData(),30)}}},{key:"bar_chart",value:function(){new L.a.Bar(".ct-chart-2",{labels:[0],series:[[0],[0]]},{seriesBarDistance:10,axisX:{offset:60},axisY:{offset:80,labelInterpolationFnc:function(t){return t},scaleMinSpace:15}})}},{key:"bar_chart_data",value:function(){var t=[],e=[],s=[];this.state.jobLogs.map((function(n){t.push(n.job_name),e.push(n.success),s.push(n.failed)})),new L.a.Bar(".ct-chart-2",{labels:t,series:[e,s]},{seriesBarDistance:10,axisX:{offset:60},axisY:{offset:80,labelInterpolationFnc:function(t){return t},scaleMinSpace:15}})}},{key:"componentDidMount",value:function(){this.call(),this.call_api(),this.set_jobLogs(),this.set_metrics(),this.bar_chart(),this.bar_chart_data()}},{key:"componentWillUnmount",value:function(){I.close()}},{key:"getUsedMemoryData",value:function(){var t=[];return t.push(this.state.used),t[0]}},{key:"getFreeMemoryData",value:function(){var t=[];return t.push(this.state.free),t[0]}},{key:"getTotalMemoryData",value:function(){var t=[];return t.push(this.state.total),t[0]}},{key:"updateUsedMemoryChart",value:function(t,e,s,n){var a=this;e.series[0].length>=n&&e.series[0].shift(),e.series[0].push(s),t.update(e),setTimeout((function(){a.updateUsedMemoryChart(t,e,a.getUsedMemoryData(),n)}),1e3)}},{key:"updateFreeMemoryChart",value:function(t,e,s,n){var a=this;e.series[0].length>=n&&e.series[0].shift(),e.series[0].push(s),t.update(e),setTimeout((function(){a.updateFreeMemoryChart(t,e,a.getFreeMemoryData(),n)}),1e3)}},{key:"updateTotalMemoryChart",value:function(t,e,s,n){var a=this;e.series[0].length>=n&&e.series[0].shift(),e.series[0].push(s),t.update(e),setTimeout((function(){a.updateTotalMemoryChart(t,e,a.getTotalMemoryData(),n)}),1e3)}},{key:"set_initial_state",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState((function(t){return{filter:"",limit:""}}),(function(){return e.set_jobLogs()}));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"set_jobLogs",value:function(){var t=this;this.call_api().then((function(e){var s=e.jobLogs;t.setState((function(t){return{jobLogs:s}}))}))}},{key:"set_metrics",value:function(){var t=this;this.fetchEtlFlowMetrics().then((function(e){var s=e.metrics;t.setState((function(t){return{metrics:s}}))}))}},{key:"render",value:function(){var t=this,e="",s="";return e=""!==this.state.filter?this.state.filter:"Add Filter (In Days)",s=""!==this.state.limit?this.state.limit:"Add limit",Object(_.jsxs)("div",{class:"container-fluid",children:[Object(_.jsxs)("div",{class:"card",children:[Object(_.jsxs)("div",{class:"card-header",children:[Object(_.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify",role:"button","aria-expanded":"true","aria-controls":"streamnotify",id:"statslinknotify"}),Object(_.jsxs)("ul",{class:"pagination float-right",children:[Object(_.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.call("false")},children:"Connect"}),Object(_.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.call("true")},children:"Close"})]})]}),Object(_.jsx)("div",{className:"collapse",id:"streamnotify",children:Object(_.jsxs)("div",{class:"card-body",children:[Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-sm-3",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsx)("div",{class:"card-header",children:"Used Memory"}),Object(_.jsx)("div",{class:"card-body",children:Object(_.jsx)("div",{class:"ct-chart"})})]})}),Object(_.jsx)("div",{class:"col-sm-3",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsx)("div",{class:"card-header",children:"Free Memory"}),Object(_.jsx)("div",{class:"card-body",children:Object(_.jsx)("div",{class:"cpu-chart"})})]})}),Object(_.jsx)("div",{class:"col-sm-3",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsx)("div",{class:"card-header",children:"Total Memory"}),Object(_.jsx)("div",{class:"card-body",children:Object(_.jsx)("div",{class:"cpu-chart-1 "})})]})}),Object(_.jsx)("div",{class:"col-sm-3",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsx)("div",{class:"card-header",children:"Current Usage"}),Object(_.jsx)("div",{class:"card-body",children:Object(_.jsx)("div",{children:Object(_.jsxs)("ul",{class:"list-group ",children:[Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Used Memory"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.used})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Free Memory"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.free})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Total Memory"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.total})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Max Memory"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.max})]})]})})})]})})]}),Object(_.jsx)("br",{})]})})]}),Object(_.jsx)("br",{}),Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-sm-9",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsxs)("div",{class:"card-header",children:[Object(_.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify1",role:"button","aria-expanded":"true","aria-controls":"streamnotify1",children:"Etl Jobs Vs Count (Success/Failed)"}),Object(_.jsxs)("ul",{class:"pagination float-right",children:[Object(_.jsxs)("div",{class:"dropdown",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:e}),Object(_.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(_.jsx)("a",{class:"dropdown-item",children:Object(_.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{filter:e}}),(function(){return t.set_jobLogs()}))},children:[" ",e," "]})})}))})]}),Object(_.jsxs)("div",{class:"dropdown",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:s}),Object(_.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.limitOperation.map((function(e){return Object(_.jsx)("a",{class:"dropdown-item",children:Object(_.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{limit:e}}),(function(){return t.set_jobLogs()}))},children:[" ",e," "]})})}))})]}),Object(_.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.set_initial_state()},children:"Clear"}),Object(_.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.set_jobLogs();var e=[],s=[],n=[];t.state.jobLogs.map((function(t){e.push(t.job_name),s.push(t.success),n.push(t.failed)})),new L.a.Bar(".ct-chart-2",{labels:e,series:[s,n]},{seriesBarDistance:10,axisX:{offset:60},axisY:{offset:80,labelInterpolationFnc:function(t){return t},scaleMinSpace:15}})},children:"Refresh"})]})]}),Object(_.jsx)("div",{className:"collapse",id:"streamnotify1",children:Object(_.jsx)("div",{class:"card-body",children:Object(_.jsx)("div",{class:"ct-chart-2"})})})]})}),Object(_.jsx)("div",{class:"col-sm-3",children:Object(_.jsxs)("div",{class:"card",children:[Object(_.jsxs)("div",{class:"card-header",children:[Object(_.jsx)("a",{className:"btn btn-secondary btn-sm","data-toggle":"collapse",href:"#streamnotify2",role:"button","aria-expanded":"true","aria-controls":"streamnotify",id:"statslinknotify",children:"Metrics"}),Object(_.jsx)("ul",{class:"pagination float-right",children:Object(_.jsx)("button",{class:"btn btn btn-sm ml-2",type:"button ",onClick:function(){t.fetchEtlFlowMetrics().then((function(e){var s=e.metrics;t.setState((function(t){return{metrics:s}}))}))},children:"Refresh"})})]}),Object(_.jsx)("div",{className:"collapse",id:"streamnotify2",children:Object(_.jsx)("div",{class:"card-body",children:Object(_.jsxs)("ul",{class:"list-group ",children:[Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Active Jobs"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.metrics.active_jobs})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Active Subscribers"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.metrics.active_subscribers})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Etl Jobs"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.metrics.etl_jobs})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Cron Jobs"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.metrics.cron_jobs})]}),Object(_.jsxs)("li",{class:"list-group-item d-flex justify-content-between align-items-center",children:[Object(_.jsx)("b",{children:"Build Time"}),Object(_.jsx)("span",{class:"badge badge-secondary badge-pill",children:this.state.metrics.build_time})]})]})})})]})})]})]})}}]),s}(a.a.Component),E=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={credential:[],loader:!1,jdbc_values:[],aws_values:[],jdbc_keys:["url","user","passsword","driver"],aws_keys:["access_key","secret_key"],errors:[],is_error:!1,credential_name:"",credential_type:"",insert_credential_type:""},n.filterOperation=["JDBC","AWS"],n}return Object(o.a)(s,[{key:"fetchEtlFlowCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),this.setState((function(t){return{loader:!0}})),t.next=5,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:"\n          query {\n            credential {\n              name\n              type\n              valid_from\n            }\n           }\n          "})});case 5:return 403===(s=t.sent).status&&this.props.logout(),t.next=9,s.json();case 9:return n=t.sent,a=n.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"updateCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s,n){var a,i,r,c,o,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",a=localStorage.getItem("Authorization"),i=JSON.stringify(n).replaceAll('"$',"").replaceAll('$"',""),r=' mutation { update_credentials (name:"'.concat(e,'", type:JDBC, value: ').concat(i,") { name } }"),"aws"===s&&(r=' mutation { update_credentials (name:"'.concat(e,'", type:AWS, value: ').concat(i,") { name } }")),t.next=7,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:a},body:JSON.stringify({query:r})});case 7:return 403===(c=t.sent).status&&this.props.logout(),t.next=11,c.json();case 11:return o=t.sent,l=o.data,d=o.errors,null!==JSON.parse(JSON.stringify(l.update_credentials))?this.set_job_error_deails(!1):this.set_job_error_deails(!0,JSON.parse(JSON.stringify(d))),t.abrupt("return",l);case 16:case"end":return t.stop()}}),t,this)})));return function(e,s,n){return t.apply(this,arguments)}}()},{key:"insertCreds",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s,n){var a,i,r,c,o,l,d;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",a=localStorage.getItem("Authorization"),i=JSON.stringify(n).replaceAll('"$',"").replaceAll('$"',""),r=' mutation { add_credentials (name:"'.concat(e,'", type:JDBC, value: ').concat(i,") { name } }"),"AWS"===s&&(r=' mutation { add_credentials (name:"'.concat(e,'", type:AWS, value: ').concat(i,") { name } }")),t.next=7,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:a},body:JSON.stringify({query:r})});case 7:return 403===(c=t.sent).status&&this.props.logout(),t.next=11,c.json();case 11:return o=t.sent,l=o.data,d=o.errors,null!==JSON.parse(JSON.stringify(l.add_credentials))?this.set_job_error_deails(!1):this.set_job_error_deails(!0,JSON.parse(JSON.stringify(d))),t.abrupt("return",l);case 16:case"end":return t.stop()}}),t,this)})));return function(e,s,n){return t.apply(this,arguments)}}()},{key:"set_notification",value:function(t){this.setState((function(e){return{notification:t}}))}},{key:"create_update_cred_ui",value:function(){var t=this;return"jdbc"===this.state.credential_type?this.state.jdbc_keys.map((function(e,s){return Object(_.jsx)("div",{children:Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.jdbc_keys[s],disabled:!0})})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:"***********",onChange:t.set_insert_values.bind(t,s)})})})]})},s)})):"aws"===this.state.credential_type?this.state.aws_keys.map((function(e,s){return Object(_.jsx)("div",{children:Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.aws_keys[s],disabled:!0})})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:"***********",onChange:t.set_insert_values.bind(t,s)})})})]})},s)})):void 0}},{key:"create_add_cred_ui",value:function(){var t=this;return"JDBC"===this.state.insert_credential_type?this.state.jdbc_keys.map((function(e,s){return Object(_.jsx)("div",{children:Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.jdbc_keys[s],disabled:!0})})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:"Type Value",onChange:t.set_values.bind(t,s)})})})]})},s)})):"AWS"===this.state.insert_credential_type?this.state.aws_keys.map((function(e,s){return Object(_.jsx)("div",{children:Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-4 col-sm-4 col-md-4",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:t.state.aws_keys[s],disabled:!0})})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsx)("input",{class:"form-control",type:"text",placeholder:"Type Value",onChange:t.set_values.bind(t,s)})})})]})},s)})):void 0}},{key:"set_add_cred_initial_state",value:function(){this.setState((function(t){return{insert_credential_type:"",aws_values:[],jdbc_values:[]}})),document.getElementById("cred_name").value=""}},{key:"set_update_cred_initial_state",value:function(){var t=Object(h.a)(j.a.mark((function t(){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState((function(t){return{aws_values:[],jdbc_values:[]}}));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"set_values",value:function(t,e){if("JDBC"===this.state.insert_credential_type){var s=Object(m.a)(this.state.jdbc_values);s[t]=e.target.value,this.setState({jdbc_values:s})}else{var n=Object(m.a)(this.state.aws_values);n[t]=e.target.value,this.setState({aws_values:n})}}},{key:"set_insert_values",value:function(t,e){if("jdbc"===this.state.credential_type){var s=Object(m.a)(this.state.jdbc_values);s[t]=e.target.value,this.setState({jdbc_values:s})}else{var n=Object(m.a)(this.state.aws_values);n[t]=e.target.value,this.setState({aws_values:n})}}},{key:"componentDidMount",value:function(){this.set_credentials()}},{key:"set_credentials",value:function(){var t=this;this.fetchEtlFlowCreds().then((function(e){var s=e.credential;t.setState((function(t){return{credential:s}}))}))}},{key:"set_cred_update_deails",value:function(t){this.setState((function(e){return{credential_name:t}}))}},{key:"update_credentials",value:function(){var t,e=this,s=[];if("jdbc"===this.state.credential_type)for(t=0;t<this.state.jdbc_keys.length;t++){var n,a=(n={},Object(p.a)(n,"$key$",this.state.jdbc_keys[t]),Object(p.a)(n,"$value$",this.state.jdbc_values[t]),n);s[t]=a}else for(t=0;t<this.state.aws_keys.length;t++){var i;a=(i={},Object(p.a)(i,"$key$",this.state.aws_keys[t]),Object(p.a)(i,"$value$",this.state.aws_values[t]),i);s[t]=a}a="";this.updateCreds(this.state.credential_name,this.state.credential_type,s).then((function(t){var s=t.update_credentials;e.set_notification(!0);JSON.parse(JSON.stringify(s))})),this.setState((function(t){return{credential_type:"",aws_values:[],jdbc_values:[]}}))}},{key:"add_credentials",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a,i,r,c=this;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=[],"JDBC"===this.state.insert_credential_type)for(s=0;s<this.state.jdbc_keys.length;s++)n={},Object(p.a)(n,"$key$",this.state.jdbc_keys[s]),Object(p.a)(n,"$value$",this.state.jdbc_values[s]),a=n,e[s]=a;else for(s=0;s<this.state.aws_keys.length;s++)i={},Object(p.a)(i,"$key$",this.state.aws_keys[s]),Object(p.a)(i,"$value$",this.state.aws_values[s]),a=i,e[s]=a;a="",r=document.getElementById("cred_name").value,this.insertCreds(r,this.state.insert_credential_type,e).then((function(t){var e=t.add_credentials;c.set_notification(!0);JSON.parse(JSON.stringify(e))}),(function(){return c.set_add_cred_initial_state()})),this.setState((function(t){return{insert_credential_type:"",aws_values:[],jdbc_values:[]}})),document.getElementById("cred_name").value="";case 7:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"set_job_error_deails",value:function(t,e){this.setState((function(s){return{is_error:t,errors:e}}))}},{key:"render",value:function(){var t=this;""!==this.state.credential_type&&this.state.credential_type;var e="";e=""!==this.state.insert_credential_type?this.state.insert_credential_type:"Add Credential Type";""!==this.state.credential_type&&this.state.credential_type;var s="";return this.state.notification&&(s=this.state.is_error?Object(_.jsxs)("div",{class:"alert alert-danger alert-dismissible fade show",role:"alert",children:[Object(_.jsx)("h4",{class:"alert-heading",children:"Error while Updatating Credential !"}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}):Object(_.jsxs)("div",{class:"alert alert-success alert-dismissible fade show",role:"alert",children:[Object(_.jsx)("h4",{class:"alert-heading",children:"Credentials  submitted successfully!  "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:function(){t.set_notification(!1)},children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]})),this.state.loader?Object(_.jsx)("div",{children:Object(_.jsx)(g,{job_run_id:this.job_run_id,set_job_run_state:this.set_job_run_state})}):Object(_.jsxs)("div",{className:"container",children:[Object(_.jsx)("div",{children:s}),Object(_.jsxs)("ul",{class:"pagination justify-content-center",children:[Object(_.jsx)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.set_credentials()},children:"Refresh"}),Object(_.jsxs)("div",{class:"inner",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal1",children:"Add New Credentials"}),Object(_.jsx)("div",{class:"modal fade",id:"exampleModal1",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel1","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel1",children:"Add Credentials"}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsxs)("div",{class:"modal-body",children:[Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsxs)("div",{class:"form-group",children:["Credential Name",Object(_.jsx)("input",{class:"form-control",placeholder:"Add Name",type:"text",id:"cred_name"})]})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsx)("div",{class:"form-group",children:Object(_.jsxs)("div",{class:"dropdown",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-light dropdown-toggle","data-toggle":"dropdown",children:e}),Object(_.jsx)("div",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton",children:this.filterOperation.map((function(e){return Object(_.jsx)("a",{class:"dropdown-item",children:Object(_.jsxs)("button",{class:"btn btn btn-sm",type:"button ",onClick:function(){t.setState((function(t){return{insert_credential_type:e}}))},children:[" ",e," "]})})}))})]})})})]}),this.create_add_cred_ui(),Object(_.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.add_credentials()}})]}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})]}),Object(_.jsxs)("table",{id:"jobruns",class:"table table-sm table-bordered",children:[Object(_.jsx)("thead",{class:"thead-dark",children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Credential Name"}),Object(_.jsx)("th",{children:"Type"}),Object(_.jsx)("th",{children:"Last Updated"}),Object(_.jsx)("th",{children:"Action"})]})}),Object(_.jsx)("tbody",{children:this.state.credential.map((function(e){return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:e.name}),Object(_.jsx)("td",{children:e.type}),Object(_.jsx)("td",{children:e.valid_from}),Object(_.jsx)("td",{children:Object(_.jsxs)("div",{class:"inner",children:[Object(_.jsx)("button",{type:"button",class:"btn btn-warning ml-2","data-toggle":"modal","data-target":"#exampleModal",onClick:function(){return t.setState((function(t){return{credential_name:e.name,credential_type:e.type}}))},children:"Update"}),Object(_.jsx)("div",{class:"modal fade",id:"exampleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Update Credentials"}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsxs)("div",{class:"modal-body",children:[Object(_.jsxs)("div",{class:"row",children:[Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsxs)("div",{class:"form-group",children:["Credential Name",Object(_.jsx)("input",{class:"form-control",placeholder:t.state.credential_name,type:"text",disabled:!0})]})}),Object(_.jsx)("div",{class:"col-xs-7 col-sm-7 col-md-7",children:Object(_.jsxs)("div",{class:"form-group",children:["Type",Object(_.jsx)("input",{class:"form-control",placeholder:t.state.credential_type,type:"text",disabled:!0})]})})]}),t.create_update_cred_ui(),Object(_.jsx)("input",{type:"button",class:"btn btn-primary ml-2",value:"Submit",onClick:function(){return t.update_credentials()}})]}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})})]})}))})]})]})}}]),s}(a.a.Component),D=s(24),F=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={stepruns:[],loader:!1},n}return Object(o.a)(s,[{key:"fetchEtlFlowJobById",value:function(){var t=Object(h.a)(j.a.mark((function t(e){var s,n,a,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",s=localStorage.getItem("Authorization"),this.setState((function(t){return{loader:!0}})),t.next=5,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:s},body:JSON.stringify({query:'\n          query {\n            stepruns(job_run_id:    "'.concat(e,'"){\n                job_run_id\n                step_name\n                properties\n                state\n                start_time\n                elapsed_time\n                step_type\n                step_run_id\n             }\n           }\n          ')})});case 5:return 403===(n=t.sent).status&&localStorage.removeItem("Authorization"),t.next=9,n.json();case 9:return a=t.sent,i=a.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",i);case 13:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.fetchEtlFlowJobs()}),1e6)}))},{key:"componentDidMount",value:function(){var t=this;this.fetchEtlFlowJobById(this.props.match.params.id).then((function(e){var s=e.stepruns;t.setState((function(t){return{stepruns:s}}))})),this.setInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"show_modal",value:function(t){var e="",s=JSON.parse(t);for(var n in s)e+="<b>"+n+"</b>="+s[n]+"<br></br>",x()("#stepRunModal .modal-body").html(e),x()("#stepRunModal").modal()}},{key:"show_step_run_state_modal",value:function(t){x()("#stepRunStateModal .modal-body").html(t),x()("#stepRunStateModal").modal()}},{key:"handleOnClick",value:function(t){this.props.history.push("/StepRunsById/"+t)}},{key:"render",value:function(){var t=this,e=!1;this.state.stepruns.map((function(t){""!==t.step_run_id&&(e=!0)}));var s="";s=e?Object(_.jsx)("th",{children:"Linked Job"}):"";var n=["EtlFlowJobStep","DPSparkJobStep","ParallelETLStep"];return this.state.loader?Object(_.jsx)("div",{children:Object(_.jsx)(g,{job_run_id:this.job_run_id,set_job_run_state:this.set_job_run_state})}):Object(_.jsx)("div",{className:"container-fluid",children:Object(_.jsxs)("table",{id:"job runs",class:"table table-sm table-bordered",children:[Object(_.jsx)("thead",{class:"thead-dark",children:Object(_.jsxs)("tr",{children:[Object(_.jsx)("th",{children:"Job Run Id"}),Object(_.jsx)("th",{children:"Step Type"}),Object(_.jsx)("th",{children:"Step Name"}),Object(_.jsx)("th",{children:"Start Time"}),Object(_.jsx)("th",{children:"Elapsed Time"}),Object(_.jsx)("th",{children:"Status"}),Object(_.jsx)("th",{children:"Properties"}),s,Object(_.jsx)("th",{children:Object(_.jsx)("button",{className:"btn btn-secondary btn-block",onClick:function(){t.props.history.push("/JobRuns")},children:"Back"})})]})}),Object(_.jsx)("tbody",{children:this.state.stepruns.map((function(e){return Object(_.jsxs)("tr",{children:[Object(_.jsx)("td",{children:e.job_run_id}),Object(_.jsx)("td",{children:e.step_type}),Object(_.jsx)("td",{children:e.step_name}),Object(_.jsx)("td",{children:e.start_time}),Object(_.jsx)("td",{children:e.elapsed_time}),Object(_.jsx)("td",{children:"pass"===e.state||""==e.state?Object(_.jsx)("div",{children:Object(_.jsx)("p",{className:"text-success",children:e.state})}):"started"===e.state||"running"==e.state?Object(_.jsx)("div",{children:Object(_.jsx)("p",{className:"text-warning",children:e.state})}):Object(_.jsxs)("div",{children:[Object(_.jsx)("button",{type:"button",class:"btn btn-danger btn btn-sm","data-toggle":"modal",onClick:function(){return t.show_step_run_state_modal(e.state)},children:"Error"}),Object(_.jsx)("div",{class:"modal fade",id:"stepRunStateModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Properties "}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]})}),Object(_.jsxs)("td",{children:[Object(_.jsx)("button",{type:"button",class:"btn btn-secondary btn-sm","data-toggle":"modal",onClick:function(){return t.show_modal(e.properties)},children:"Properties"}),Object(_.jsx)("div",{class:"modal fade",id:"stepRunModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:Object(_.jsx)("div",{class:"modal-dialog",role:"document",children:Object(_.jsxs)("div",{class:"modal-content",children:[Object(_.jsxs)("div",{class:"modal-header",children:[Object(_.jsx)("h5",{class:"modal-title",id:"exampleModalLabel",children:"Step Properties"}),Object(_.jsx)("button",{type:"button",class:"close","data-dismiss":"modal","aria-label":"Close",children:Object(_.jsx)("span",{"aria-hidden":"true",children:"\xd7"})})]}),Object(_.jsx)("div",{class:"modal-body"}),Object(_.jsx)("div",{class:"modal-footer",children:Object(_.jsx)("button",{type:"button",class:"btn btn-secondary","data-dismiss":"modal",children:"Close"})})]})})})]}),Object(_.jsx)("td",{children:n.includes(e.step_type)?Object(_.jsx)("input",{type:"button",value:"Check Progress",class:"btn btn-secondary btn-sm",onClick:function(){return t.fetchEtlFlowJobById(e.step_run_id).then((function(e){var s=e.stepruns;t.setState((function(t){return{stepruns:s}}))}))}}):Object(_.jsx)("div",{})})]})}))})]})})}}]),s}(a.a.Component),q=Object(f.f)(F),R=(s(53),function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).get_etl_jobs=function(){n.fetchEtlFlowJobs().then((function(t){var e=t.jobs;n.setState((function(t){return{jobs:e}}))}))},n.state={jobs:[],metrics:[],user:"",loader:!1},n}return Object(o.a)(s,[{key:"fetchEtlFlowJobs",value:function(){var t=Object(h.a)(j.a.mark((function t(){var e,s,n,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/etlflow",e=localStorage.getItem("Authorization"),this.setState((function(t){return{loader:!0}})),t.next=5,fetch("/api/etlflow",{method:"POST",headers:{content_type:"applcation/json",Authorization:e},body:JSON.stringify({query:"\n          query {\n              jobs {\n                name \n                schedule\n                props {key value} \n                nextSchedule \n                schduleRemainingTime \n                is_active \n                last_run_time\n                last_run_description\n             }\n           }\n          "})});case 5:return 403===(s=t.sent).status&&this.remove_token(),t.next=9,s.json();case 9:return n=t.sent,a=n.data,this.setState((function(t){return{loader:!1}})),t.abrupt("return",a);case 13:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"setInterval",value:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;this.timerID=setInterval((function(){return t.fetchEtlFlowJobs()}),1e6)}))},{key:"fetchEtlFlowUserDetails",value:function(){var t=localStorage.getItem("Authorization"),e=JSON.parse(JSON.stringify(Object(N.a)(t)));this.setState({user:e.user})}},{key:"componentDidMount",value:function(){var t=this;this.fetchEtlFlowJobs().then((function(e){var s=e.jobs;t.setState((function(t){return{jobs:s}}))})),this.fetchEtlFlowUserDetails()}},{key:"remove_token",value:function(){localStorage.removeItem("Authorization"),this.props.doLogout("")}},{key:"render",value:function(){var t=this;return this.state.loader?Object(_.jsx)("div",{children:Object(_.jsx)(g,{job_run_id:this.job_run_id,set_job_run_state:this.set_job_run_state})}):Object(_.jsxs)(D.a,{children:[Object(_.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark mb-3",children:[Object(_.jsxs)("ul",{className:"nav navbar-nav w-100",children:[Object(_.jsxs)("li",{className:"nav-item nav-link",children:[Object(_.jsx)(D.b,{to:"/",children:"Jobs"})," "]}),Object(_.jsxs)("li",{className:"nav-item nav-link",children:[Object(_.jsx)(D.b,{to:"/JobRuns",children:"Job Runs"})," "]}),Object(_.jsxs)("li",{className:"nav-item nav-link",children:[Object(_.jsx)(D.b,{to:"/JobLogs",children:"Job Logs"})," "]}),Object(_.jsxs)("li",{className:"nav-item nav-link",children:[Object(_.jsx)(D.b,{to:"/Stats",children:"Stats"})," "]}),Object(_.jsxs)("li",{className:"nav-item nav-link",children:[Object(_.jsx)(D.b,{to:"/Credentials",children:"Credentials"})," "]})]}),Object(_.jsx)("div",{class:"navbar-collapse collapse w-100 order-3 dual-collapse2",children:Object(_.jsxs)("ul",{class:"nav justify-content-end w-100",children:[Object(_.jsx)(J,{}),Object(_.jsxs)("li",{class:"nav-item dropdown",children:[Object(_.jsx)("a",{class:"nav-link  dropdown-toggle",href:"#","data-toggle":"dropdown",children:this.state.user}),Object(_.jsxs)("ul",{class:"dropdown-menu",children:[Object(_.jsx)("li",{children:Object(_.jsx)("a",{class:"dropdown-item",href:"https://github.com/tharwaninitin/etlflow",children:"Git Hub"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{class:"dropdown-item",href:"https://tharwaninitin.github.io/etlflow/site/",children:"Docs"})}),Object(_.jsx)("li",{children:Object(_.jsx)("a",{class:"dropdown-item",children:Object(_.jsx)("input",{type:"button",class:"btn btn-secondary btn-sm",value:"LogOut",onClick:function(){return t.remove_token()}})})})]})]})]})})]}),Object(_.jsxs)(f.c,{children:[Object(_.jsx)(f.a,{exact:!0,path:"/",component:function(){return Object(_.jsx)(y,{jobs:t.state.jobs,logout:t.props.doLogout,get_etl_jobs:t.get_etl_jobs})}}),Object(_.jsx)(f.a,{path:"/JobRuns/:job_name?",component:function(){return Object(_.jsx)(w,{logout:t.props.doLogout,jobs:t.state.jobs})}}),Object(_.jsx)(f.a,{path:"/JobLogs",component:function(){return Object(_.jsx)(C,{logout:t.props.doLogout})}}),Object(_.jsx)(f.a,{path:"/Stats",component:function(){return Object(_.jsx)(T,{logout:t.props.doLogout})}}),Object(_.jsx)(f.a,{path:"/Credentials",component:function(){return Object(_.jsx)(E,{logout:t.props.doLogout})}}),Object(_.jsx)(f.a,{path:"/JobRunDetails/:id",component:function(){return Object(_.jsx)(q,{})}})]})]})}}]),s}(a.a.Component)),$=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={user_name:"",password:"",token:"",login:[]},n.login_validation=n.login_validation.bind(Object(l.a)(n)),n.set_login_user_name=n.set_login_user_name.bind(Object(l.a)(n)),n.set_login_password=n.set_login_password.bind(Object(l.a)(n)),n}return Object(o.a)(s,[{key:"fetchLoginDetails",value:function(){var t=Object(h.a)(j.a.mark((function t(e,s){var n,a,i;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"/api/login",t.next=3,fetch("/api/login",{method:"POST",headers:{content_type:"applcation/json"},body:JSON.stringify({query:'\n          mutation {\n            login (user_name: "'.concat(e,'", password: "').concat(s,'") {\n                message \n                token\n             }\n           }\n          ')})});case 3:return n=t.sent,t.next=6,n.json();case 6:return a=t.sent,i=a.data,t.abrupt("return",i);case 9:case"end":return t.stop()}}),t)})));return function(e,s){return t.apply(this,arguments)}}()},{key:"login_validation",value:function(){var t=this;this.fetchLoginDetails(this.state.user_name,this.state.password).then((function(e){var s=e.login,n=JSON.parse(JSON.stringify(s)).token;""!==n?(localStorage.setItem("Authorization",n),t.props.doLogin(n),t.setState((function(t){return{token:n}}))):alert("Invalid User")}))}},{key:"set_login_user_name",value:function(){this.setState((function(t){return{user_name:document.getElementById("user_name").value}}))}},{key:"set_login_password",value:function(){this.setState((function(t){return{password:document.getElementById("password").value}}))}},{key:"render",value:function(){var t=this;return Object(_.jsxs)("div",{className:"main",align:"center",children:[Object(_.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark mb-3",children:Object(_.jsx)("ul",{className:"nav navbar-nav w-50",children:Object(_.jsx)("li",{className:"nav-item nav-link",children:"EtlFlow"})})}),Object(_.jsx)("div",{className:"col-md-3",children:Object(_.jsx)("div",{className:"login-form ",children:Object(_.jsxs)("form",{id:"form_login",className:"text-center border border-dark p-5",onSubmit:function(e){t.login_validation(),e.preventDefault()},children:[Object(_.jsx)("p",{className:"h4 mb-4",children:"EtlFlow Login"}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsx)("input",{type:"text",className:"form-control","aria-describedby":"UsernameHelp",placeholder:"Username",id:"user_name",onChange:function(e){return t.set_login_user_name()}})}),Object(_.jsx)("div",{className:"form-group",children:Object(_.jsx)("input",{type:"password",className:"form-control","aria-describedby":"PasswordHelp",placeholder:"Password",id:"password",onChange:function(e){return t.set_login_password()}})}),Object(_.jsx)("button",{type:"submit",className:"btn btn-secondary btn-block",children:"Submit"})]})})})]})}}]),s}(a.a.Component),z=function(t){Object(d.a)(s,t);var e=Object(u.a)(s);function s(t){var n;return Object(c.a)(this,s),(n=e.call(this,t)).state={token:""},n.doLogin=n.doLogin.bind(Object(l.a)(n)),n.doLogout=n.doLogout.bind(Object(l.a)(n)),n}return Object(o.a)(s,[{key:"doLogin",value:function(t,e){this.setState({token:t})}},{key:"doLogout",value:function(t){this.setState({token:""})}},{key:"render",value:function(){return null===localStorage.getItem("Authorization")?Object(_.jsx)("div",{children:Object(_.jsx)($,{doLogin:this.doLogin})}):Object(_.jsx)("div",{children:Object(_.jsx)(R,{doLogout:this.doLogin})})}}]),s}(a.a.Component);window.login_url="/api/login",window.url="/api/etlflow",r.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsx)(z,{})}),document.getElementById("root"))}},[[54,1,2]]]);
//# sourceMappingURL=main.05b63544.chunk.js.map